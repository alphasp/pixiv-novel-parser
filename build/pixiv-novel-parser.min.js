!function(a){var b="process"in a,c=function(){function a(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c}function b(a,b,c,d,e,f){this.message=a,this.expected=b,this.found=c,this.offset=d,this.line=e,this.column=f,this.name="SyntaxError"}function c(a){function c(b){function c(b,c,d){var e,f;for(e=c;d>e;e++)f=a.charAt(e),"\n"===f?(b.seenCR||b.line++,b.column=1,b.seenCR=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(b.line++,b.column=1,b.seenCR=!0):(b.column++,b.seenCR=!1)}return kc!==b&&(kc>b&&(kc=0,lc={line:1,column:1,seenCR:!1}),c(lc,kc,b),kc=b),lc}function d(a){mc>ic||(ic>mc&&(mc=ic,nc=[]),nc.push(a))}function e(d,e,f){function g(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function h(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0180-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1080-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d,e,f,g=Array(a.length);for(f=0;f<a.length;f++)g[f]=a[f].description;return d=a.length>1?g.slice(0,-1).join(", ")+" or "+g[a.length-1]:g[0],e=b?'"'+c(b)+'"':"end of input","Expected "+d+" but "+e+" found."}var i=c(f),j=f<a.length?a.charAt(f):null;return null!==e&&g(e),new b(null!==d?d:h(e,j),e,j,f,i.line,i.column)}function f(){var a;return a=g()}function g(){var a,b;for(a=[],b=i(),b===M&&(b=h());b!==M;)a.push(b),b=i(),b===M&&(b=h());return a}function h(){var b,c,e;if(b=ic,c=[],Q.test(a.charAt(ic))?(e=a.charAt(ic),ic++):(e=M,0===oc&&d(R)),e!==M)for(;e!==M;)c.push(e),Q.test(a.charAt(ic))?(e=a.charAt(ic),ic++):(e=M,0===oc&&d(R));else c=P;return c!==M&&(jc=b,c=S(c)),b=c}function i(){var a;return a=j(),a===M&&(a=k(),a===M&&(a=l(),a===M&&(a=m(),a===M&&(a=n(),a===M&&(a=o()))))),a}function j(){var b,c,e;return b=ic,a.substr(ic,9)===T?(c=T,ic+=9):(c=M,0===oc&&d(U)),c!==M?(e=x(),e===M&&(e=V),e!==M?(jc=b,c=W(),b=c):(ic=b,b=P)):(ic=b,b=P),b}function k(){var b,c,e,f;return b=ic,a.substr(ic,9)===X?(c=X,ic+=9):(c=M,0===oc&&d(Y)),c!==M?(e=p(),e!==M?(93===a.charCodeAt(ic)?(f=Z,ic++):(f=M,0===oc&&d($)),f!==M?(jc=b,c=_(e),b=c):(ic=b,b=P)):(ic=b,b=P)):(ic=b,b=P),b}function l(){var b,c,e,f,g,h;return b=ic,a.substr(ic,12)===ab?(c=ab,ic+=12):(c=M,0===oc&&d(bb)),c!==M?(e=r(),e!==M?(f=ic,45===a.charCodeAt(ic)?(g=cb,ic++):(g=M,0===oc&&d(db)),g!==M?(h=s(),h!==M?(g=[g,h],f=g):(ic=f,f=P)):(ic=f,f=P),f===M&&(f=V),f!==M?(93===a.charCodeAt(ic)?(g=Z,ic++):(g=M,0===oc&&d($)),g!==M?(jc=b,c=eb(e,f),b=c):(ic=b,b=P)):(ic=b,b=P)):(ic=b,b=P)):(ic=b,b=P),b}function m(){var b,c,e,f;return b=ic,a.substr(ic,6)===fb?(c=fb,ic+=6):(c=M,0===oc&&d(gb)),c!==M?(e=s(),e!==M?(93===a.charCodeAt(ic)?(f=Z,ic++):(f=M,0===oc&&d($)),f!==M?(jc=b,c=hb(e),b=c):(ic=b,b=P)):(ic=b,b=P)):(ic=b,b=P),b}function n(){var b,c,e,f,g,h,i,j;if(b=ic,a.substr(ic,10)===ib?(c=ib,ic+=10):(c=M,0===oc&&d(jb)),c!==M)if(e=q(),e!==M)if(62===a.charCodeAt(ic)?(f=kb,ic++):(f=M,0===oc&&d(lb)),f!==M){for(g=[],h=D();h!==M;)g.push(h),h=D();if(g!==M)if(h=t(),h!==M){for(i=[],j=D();j!==M;)i.push(j),j=D();i!==M?(a.substr(ic,2)===mb?(j=mb,ic+=2):(j=M,0===oc&&d(nb)),j!==M?(jc=b,c=ob(e,h),b=c):(ic=b,b=P)):(ic=b,b=P)}else ic=b,b=P;else ic=b,b=P}else ic=b,b=P;else ic=b,b=P;else ic=b,b=P;return b}function o(){var b,c;return b=ic,91===a.charCodeAt(ic)?(c=pb,ic++):(c=M,0===oc&&d(qb)),c!==M&&(jc=b,c=rb()),b=c}function p(){var b,c,e;for(b=ic,c=[],sb.test(a.charAt(ic))?(e=a.charAt(ic),ic++):(e=M,0===oc&&d(tb));e!==M;)c.push(e),sb.test(a.charAt(ic))?(e=a.charAt(ic),ic++):(e=M,0===oc&&d(tb));return c!==M&&(jc=b,c=ub(c)),b=c}function q(){var b,c,e;for(b=ic,c=[],vb.test(a.charAt(ic))?(e=a.charAt(ic),ic++):(e=M,0===oc&&d(wb));e!==M;)c.push(e),vb.test(a.charAt(ic))?(e=a.charAt(ic),ic++):(e=M,0===oc&&d(wb));return c!==M&&(jc=b,c=ub(c)),b=c}function r(){var a,b,c;if(a=ic,b=[],c=y(),c!==M)for(;c!==M;)b.push(c),c=y();else b=P;return b!==M&&(jc=a,b=xb(b)),a=b}function s(){var a,b,c;if(a=ic,b=[],c=y(),c!==M)for(;c!==M;)b.push(c),c=y();else b=P;return b!==M&&(jc=a,b=yb(b)),a=b}function t(){var b,c,e,f,g,h,i;if(b=ic,c=ic,a.substr(ic,4)===zb?(e=zb,ic+=4):(e=M,0===oc&&d(Ab)),e!==M)if(115===a.charCodeAt(ic)?(f=Bb,ic++):(f=M,0===oc&&d(Cb)),f===M&&(f=V),f!==M)if(a.substr(ic,3)===Db?(g=Db,ic+=3):(g=M,0===oc&&d(Eb)),g!==M){for(h=[],i=u();i!==M;)h.push(i),i=u();h!==M?(e=[e,f,g,h],c=e):(ic=c,c=P)}else ic=c,c=P;else ic=c,c=P;else ic=c,c=P;return c!==M&&(jc=b,c=Fb(c)),b=c}function u(){var b,c,e,f;if(b=v(),b===M&&(b=y(),b===M)){if(b=ic,37===a.charCodeAt(ic)?(c=Gb,ic++):(c=M,0===oc&&d(Hb)),c!==M){if(e=[],f=z(),f!==M)for(;f!==M;)e.push(f),f=z();else e=P;e!==M?(c=[c,e],b=c):(ic=b,b=P)}else ic=b,b=P;b===M&&(Ib.test(a.charAt(ic))?(b=a.charAt(ic),ic++):(b=M,0===oc&&d(Jb)))}return b}function v(){var b;return Kb.test(a.charAt(ic))?(b=a.charAt(ic),ic++):(b=M,0===oc&&d(Lb)),b===M&&(Mb.test(a.charAt(ic))?(b=a.charAt(ic),ic++):(b=M,0===oc&&d(Nb))),b}function w(){var b;return 13===a.charCodeAt(ic)?(b=Ob,ic++):(b=M,0===oc&&d(Pb)),b}function x(){var a,b,c;return a=ic,b=w(),b!==M?(c=B(),c!==M?(b=[b,c],a=b):(ic=a,a=P)):(ic=a,a=P),a}function y(){var b;return Qb.test(a.charAt(ic))?(b=a.charAt(ic),ic++):(b=M,0===oc&&d(Rb)),b}function z(){var b;return b=y(),b===M&&(65===a.charCodeAt(ic)?(b=Sb,ic++):(b=M,0===oc&&d(Tb)),b===M&&(66===a.charCodeAt(ic)?(b=Ub,ic++):(b=M,0===oc&&d(Vb)),b===M&&(67===a.charCodeAt(ic)?(b=Wb,ic++):(b=M,0===oc&&d(Xb)),b===M&&(68===a.charCodeAt(ic)?(b=Yb,ic++):(b=M,0===oc&&d(Zb)),b===M&&(69===a.charCodeAt(ic)?(b=$b,ic++):(b=M,0===oc&&d(_b)),b===M&&(70===a.charCodeAt(ic)?(b=ac,ic++):(b=M,0===oc&&d(bc)))))))),b}function A(){var b;return 9===a.charCodeAt(ic)?(b=cc,ic++):(b=M,0===oc&&d(dc)),b}function B(){var b;return 10===a.charCodeAt(ic)?(b=ec,ic++):(b=M,0===oc&&d(fc)),b}function C(){var b;return 32===a.charCodeAt(ic)?(b=gc,ic++):(b=M,0===oc&&d(hc)),b}function D(){var a;return a=C(),a===M&&(a=A()),a}function E(a){return a?"[object String]"===Object.prototype.toString.call(a)?a:(a=a.reduce(function(a,b){return"[object Array]"===Object.prototype.toString.call(b)&&(b=E(b)),a+(""+(b||""))},""),a.replace(/\r?\n/g,"\n").replace(/[\s\u200c]/g,function(a){return"\n"===a||"ã€€"===a?a:" "})):""}function F(){return{type:"tag",name:"newpage"}}function G(a){return{type:"tag",name:"chapter",title:a}}function H(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b}}function I(a){return{type:"tag",name:"jump",pageNumber:a}}function J(a,b){return{type:"tag",name:"jumpuri",title:a,uri:E(b)}}var K,L=arguments.length>1?arguments[1]:{},M={},N={start:f},O=f,P=M,Q=/^[^[]/,R={type:"class",value:"[^[]",description:"[^[]"},S=function(a){return{type:"text",val:E(a)}},T="[newpage]",U={type:"literal",value:"[newpage]",description:'"[newpage]"'},V=null,W=function(){return F()},X="[chapter:",Y={type:"literal",value:"[chapter:",description:'"[chapter:"'},Z="]",$={type:"literal",value:"]",description:'"]"'},_=function(a){return G(a)},ab="[pixivimage:",bb={type:"literal",value:"[pixivimage:",description:'"[pixivimage:"'},cb="-",db={type:"literal",value:"-",description:'"-"'},eb=function(a,b){return H(a,b&&b[1])},fb="[jump:",gb={type:"literal",value:"[jump:",description:'"[jump:"'},hb=function(a){return I(a)},ib="[[jumpuri:",jb={type:"literal",value:"[[jumpuri:",description:'"[[jumpuri:"'},kb=">",lb={type:"literal",value:">",description:'">"'},mb="]]",nb={type:"literal",value:"]]",description:'"]]"'},ob=function(a,b){return J(a,b)},pb="[",qb={type:"literal",value:"[",description:'"["'},rb=function(){return{type:"text",val:"["}},sb=/^[^\]]/,tb={type:"class",value:"[^\\]]",description:"[^\\]]"},ub=function(a){return E(a).trim()},vb=/^[^>]/,wb={type:"class",value:"[^>]",description:"[^>]"},xb=function(a){return E(a)},yb=function(a){return parseInt(E(a),10)},zb="http",Ab={type:"literal",value:"http",description:'"http"'},Bb="s",Cb={type:"literal",value:"s",description:'"s"'},Db="://",Eb={type:"literal",value:"://",description:'"://"'},Fb=function(a){return E(a)},Gb="%",Hb={type:"literal",value:"%",description:'"%"'},Ib=/^[\-._~!$&'()*+,;=:\/@.?#]/,Jb={type:"class",value:"[\\-._~!$&'()*+,;=:\\/@.?#]",description:"[\\-._~!$&'()*+,;=:\\/@.?#]"},Kb=/^[A-Z]/,Lb={type:"class",value:"[A-Z]",description:"[A-Z]"},Mb=/^[a-z]/,Nb={type:"class",value:"[a-z]",description:"[a-z]"},Ob="\r",Pb={type:"literal",value:"\r",description:'"\\r"'},Qb=/^[0-9]/,Rb={type:"class",value:"[0-9]",description:"[0-9]"},Sb="A",Tb={type:"literal",value:"A",description:'"A"'},Ub="B",Vb={type:"literal",value:"B",description:'"B"'},Wb="C",Xb={type:"literal",value:"C",description:'"C"'},Yb="D",Zb={type:"literal",value:"D",description:'"D"'},$b="E",_b={type:"literal",value:"E",description:'"E"'},ac="F",bc={type:"literal",value:"F",description:'"F"'},cc="	",dc={type:"literal",value:"	",description:'"\\t"'},ec="\n",fc={type:"literal",value:"\n",description:'"\\n"'},gc=" ",hc={type:"literal",value:" ",description:'" "'},ic=0,jc=0,kc=0,lc={line:1,column:1,seenCR:!1},mc=0,nc=[],oc=0;if("startRule"in L){if(!(L.startRule in N))throw Error("Can't start parsing from rule \""+L.startRule+'".');O=N[L.startRule]}if(K=O(),K!==M&&ic===a.length)return K;throw K!==M&&ic<a.length&&d({type:"end",description:"end of input"}),e(null,nc,mc)}return a(b,Error),{SyntaxError:b,parse:c}}();b?module.exports=c:(a.PixivNovelParser=a.PixivNovelParser||{},a.PixivNovelParser.parser=c)}((this||0).self||global),function(a){"use strict";function b(){this.tree=[]}var c,d="process"in a;c=d?require("./parser.peg.js"):PixivNovelParser.parser,b.parse=function(a){try{return c.parse(a).reduce(function(a,b){var c=a[a.length-1];return"text"===b.type&&c&&"text"===c.type?c.val+=b.val:a.push(b),a},[])}catch(b){return console.error(b),[{type:"text",val:a}]}},b.prototype.parse=function(a){return this.tree=b.parse(a),this},b.prototype.toJSON=function(){return JSON.stringify(this.tree)},d?module.exports=b:(a.PixivNovelParser=a.PixivNovalPerser||{},a.PixivNovelParser.Parser=b)}((this||0).self||global),function(a){"use strict";var b="process"in a;b?module.exports=require("./parser"):a.PixivNovelParser=a.PixivNovelParser||{}}((this||0).self||global);
//# sourceMappingURL=pixiv-novel-parser.min.js.map