!function(a){var b="process"in a,c=function(){var a={parse:function(a,b){function c(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function d(a){var b=a.charCodeAt(0);if(255>=b)var d="x",e=2;else var d="u",e=4;return"\\"+d+c(b.toString(16).toUpperCase(),"0",e)}function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,d)+'"'}function f(a){V>T||(T>V&&(V=T,W=[]),W.push(a))}function g(){var a="novel@"+T,b=X[a];if(b)return T=b.nextPos,b.result;var c=[],d=i();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}for(;null!==e;){c.push(e);var d=i();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}}return X[a]={nextPos:T,result:c},c}function h(){var b="text@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T;if(null!==a.substr(T).match(/^[^[]/)){var e=a.charAt(T);T++}else{var e=null;U&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(T).match(/^[^[]/)){var e=a.charAt(T);T++}else{var e=null;U&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var j=T,k=T,l=U;U=!1;var m=T,n=U;U=!1;var o=i();if(U=n,null===o)var p="";else{var p=null;T=m}if(U=l,null!==p){var q="";T=k}else var q=null;if(null!==q){if("["===a.substr(T,1)){var r="[";T+=1}else{var r=null;U&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;T=j}}else{var s=null;T=j}if(null!==s)var h=s;else var h=null}if(null!==h)for(var t=[];null!==h;){if(t.push(h),null!==a.substr(T).match(/^[^[]/)){var e=a.charAt(T);T++}else{var e=null;U&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(T).match(/^[^[]/)){var e=a.charAt(T);T++}else{var e=null;U&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var j=T,k=T,l=U;U=!1;var m=T,n=U;U=!1;var o=i();if(U=n,null===o)var p="";else{var p=null;T=m}if(U=l,null!==p){var q="";T=k}else var q=null;if(null!==q){if("["===a.substr(T,1)){var r="[";T+=1}else{var r=null;U&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;T=j}}else{var s=null;T=j}if(null!==s)var h=s;else var h=null}}else var t=null;var u=null!==t?function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].join("");return M(b)}(t):null;if(null!==u)var v=u;else{var v=null;T=d}return X[b]={nextPos:T,result:v},v}function i(){var a="tag@"+T,b=X[a];if(b)return T=b.nextPos,b.result;var c=j();if(null!==c)var d=c;else{var e=k();if(null!==e)var d=e;else{var f=l();if(null!==f)var d=f;else{var g=m();if(null!==g)var d=g;else{var h=n();if(null!==h)var d=h;else var d=null}}}}return X[a]={nextPos:T,result:d},d}function j(){var b="tagNewpage@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T,e=T;if("[newpage]"===a.substr(T,9)){var g="[newpage]";T+=9}else{var g=null;U&&f('"[newpage]"')}if(null!==g){var h=x();if(null!==h)var i=h;else{var j=E();if(null!==j)var i=j;else var i=null}var k=null!==i?i:"";if(null!==k)var l=[g,k];else{var l=null;T=e}}else{var l=null;T=e}var m=null!==l?function(){return N()}():null;if(null!==m)var n=m;else{var n=null;T=d}return X[b]={nextPos:T,result:n},n}function k(){var b="tagChapter@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T,e=T;if("[chapter:"===a.substr(T,9)){var g="[chapter:";T+=9}else{var g=null;U&&f('"[chapter:"')}if(null!==g){var h=o();if(null!==h){if("]"===a.substr(T,1)){var i="]";T+=1}else{var i=null;U&&f('"]"')}if(null!==i){var j=x();if(null!==j)var k=j;else{var l=E();if(null!==l)var k=l;else var k=null}var m=null!==k?k:"";if(null!==m)var n=[g,h,i,m];else{var n=null;T=e}}else{var n=null;T=e}}else{var n=null;T=e}}else{var n=null;T=e}var p=null!==n?function(a){return O(a)}(n[1]):null;if(null!==p)var q=p;else{var q=null;T=d}return X[b]={nextPos:T,result:q},q}function l(){var b="tagPixivimage@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T,e=T;if("[pixivimage:"===a.substr(T,12)){var g="[pixivimage:";T+=12}else{var g=null;U&&f('"[pixivimage:"')}if(null!==g){var h=q();if(null!==h){var i=T;if("-"===a.substr(T,1)){var j="-";T+=1}else{var j=null;U&&f('"-"')}if(null!==j){var k=r();if(null!==k)var l=[j,k];else{var l=null;T=i}}else{var l=null;T=i}var m=null!==l?l:"";if(null!==m){if("]"===a.substr(T,1)){var n="]";T+=1}else{var n=null;U&&f('"]"')}if(null!==n)var o=[g,h,m,n];else{var o=null;T=e}}else{var o=null;T=e}}else{var o=null;T=e}}else{var o=null;T=e}var p=null!==o?function(a,b){return P(a,b&&b[1])}(o[1],o[2]):null;if(null!==p)var s=p;else{var s=null;T=d}return X[b]={nextPos:T,result:s},s}function m(){var b="tagJump@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T,e=T;if("[jump:"===a.substr(T,6)){var g="[jump:";T+=6}else{var g=null;U&&f('"[jump:"')}if(null!==g){var h=r();if(null!==h){if("]"===a.substr(T,1)){var i="]";T+=1}else{var i=null;U&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;T=e}}else{var j=null;T=e}}else{var j=null;T=e}var k=null!==j?function(a){return Q(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;T=d}return X[b]={nextPos:T,result:l},l}function n(){var b="tagJumpuri@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T,e=T;if("[[jumpuri:"===a.substr(T,10)){var g="[[jumpuri:";T+=10}else{var g=null;U&&f('"[[jumpuri:"')}if(null!==g){var h=p();if(null!==h){if(">"===a.substr(T,1)){var i=">";T+=1}else{var i=null;U&&f('">"')}if(null!==i){for(var j=[],k=J();null!==k;){j.push(k);var k=J()}if(null!==j){var l=s();if(null!==l){for(var m=[],n=J();null!==n;){m.push(n);var n=J()}if(null!==m){if("]]"===a.substr(T,2)){var o="]]";T+=2}else{var o=null;U&&f('"]]"')}if(null!==o)var q=[g,h,i,j,l,m,o];else{var q=null;T=e}}else{var q=null;T=e}}else{var q=null;T=e}}else{var q=null;T=e}}else{var q=null;T=e}}else{var q=null;T=e}}else{var q=null;T=e}var r=null!==q?function(a,b){return R(a,b)}(q[1],q[4]):null;if(null!==r)var t=r;else{var t=null;T=d}return X[b]={nextPos:T,result:t},t}function o(){var b="chapterTitle@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T,e=[];if(null!==a.substr(T).match(/^[^\]]/)){var g=a.charAt(T);T++}else{var g=null;U&&f("[^\\]]")}for(;null!==g;)if(e.push(g),null!==a.substr(T).match(/^[^\]]/)){var g=a.charAt(T);T++}else{var g=null;U&&f("[^\\]]")}var h=null!==e?function(a){return a.join("").trim()}(e):null;if(null!==h)var i=h;else{var i=null;T=d}return X[b]={nextPos:T,result:i},i}function p(){var b="jumpuriTitle@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T,e=[];if(null!==a.substr(T).match(/^[^>]/)){var g=a.charAt(T);T++}else{var g=null;U&&f("[^>]")}for(;null!==g;)if(e.push(g),null!==a.substr(T).match(/^[^>]/)){var g=a.charAt(T);T++}else{var g=null;U&&f("[^>]")}var h=null!==e?function(a){return a.join("").trim()}(e):null;if(null!==h)var i=h;else{var i=null;T=d}return X[b]={nextPos:T,result:i},i}function q(){var a="numeric@"+T,b=X[a];if(b)return T=b.nextPos,b.result;var c=T,d=A();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=A()}else var e=null;var f=null!==e?function(a){return a.join("")}(e):null;if(null!==f)var g=f;else{var g=null;T=c}return X[a]={nextPos:T,result:g},g}function r(){var a="integer@"+T,b=X[a];if(b)return T=b.nextPos,b.result;var c=T,d=A();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=A()}else var e=null;var f=null!==e?function(a){return parseInt(a.join(""),10)}(e):null;if(null!==f)var g=f;else{var g=null;T=c}return X[a]={nextPos:T,result:g},g}function s(){var b="URI@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=T,e=T,g=T;if("http"===a.substr(T,4)){var h="http";T+=4}else{var h=null;U&&f('"http"')}if(null!==h){if("s"===a.substr(T,1)){var i="s";T+=1}else{var i=null;U&&f('"s"')}var j=null!==i?i:"";if(null!==j){if("://"===a.substr(T,3)){var k="://";T+=3}else{var k=null;U&&f('"://"')}if(null!==k)var l=[h,j,k];else{var l=null;T=g}}else{var l=null;T=g}}else{var l=null;T=g}if(null!==l){for(var m=[],n=t();null!==n;){m.push(n);var n=t()}if(null!==m)var o=[l,m];else{var o=null;T=e}}else{var o=null;T=e}var p=null!==o?function(a,b){return a.join("")+b.join("")}(o[0],o[1]):null;if(null!==p)var q=p;else{var q=null;T=d}return X[b]={nextPos:T,result:q},q}function t(){var b="uri_chrs@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=u();if(null!==d)var e=d;else{var g=A();if(null!==g)var e=g;else{var h=T;if("%"===a.substr(T,1)){var i="%";T+=1}else{var i=null;U&&f('"%"')}if(null!==i){var j=C();if(null!==j)for(var k=[];null!==j;){k.push(j);var j=C()}else var k=null;if(null!==k)var l=[i,k];else{var l=null;T=h}}else{var l=null;T=h}if(null!==l)var e=l;else{if(null!==a.substr(T).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var m=a.charAt(T);T++}else{var m=null;U&&f("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==m)var e=m;else var e=null}}}return X[b]={nextPos:T,result:e},e}function u(){var b="ALPHA@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if(null!==a.substr(T).match(/^[A-Z]/)){var d=a.charAt(T);T++}else{var d=null;U&&f("[A-Z]")}if(null!==d)var e=d;else{if(null!==a.substr(T).match(/^[a-z]/)){var g=a.charAt(T);T++}else{var g=null;U&&f("[a-z]")}if(null!==g)var e=g;else var e=null}return X[b]={nextPos:T,result:e},e}function v(){var b="BIT@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if("0"===a.substr(T,1)){var d="0";T+=1}else{var d=null;U&&f('"0"')}if(null!==d)var e=d;else{if("1"===a.substr(T,1)){var g="1";T+=1}else{var g=null;U&&f('"1"')}if(null!==g)var e=g;else var e=null}return X[b]={nextPos:T,result:e},e}function w(){var b="CHAR@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if(null!==a.substr(T).match(/^[-]/)){var d=a.charAt(T);T++}else{var d=null;U&&f("[-]")}return X[b]={nextPos:T,result:d},d}function x(){var b="CR@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if("\r"===a.substr(T,1)){var d="\r";T+=1}else{var d=null;U&&f('"\\r"')}return X[b]={nextPos:T,result:d},d}function y(){var a="CRLF@"+T,b=X[a];if(b)return T=b.nextPos,b.result;var c=T,d=x();if(null!==d){var e=E();if(null!==e)var f=[d,e];else{var f=null;T=c}}else{var f=null;T=c}return X[a]={nextPos:T,result:f},f}function z(){var b="CTL@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if(null!==a.substr(T).match(/^[\0-]/)){var d=a.charAt(T);T++}else{var d=null;U&&f("[\\0-]")}if(null!==d)var e=d;else{if(""===a.substr(T,1)){var g="";T+=1}else{var g=null;U&&f('""')}if(null!==g)var e=g;else var e=null}return X[b]={nextPos:T,result:e},e}function A(){var b="DIGIT@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if(null!==a.substr(T).match(/^[0-9]/)){var d=a.charAt(T);T++}else{var d=null;U&&f("[0-9]")}return X[b]={nextPos:T,result:d},d}function B(){var b="DQUOTE@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if(null!==a.substr(T).match(/^["]/)){var d=a.charAt(T);T++}else{var d=null;U&&f('["]')}return X[b]={nextPos:T,result:d},d}function C(){var b="HEXDIG@"+T,c=X[b];if(c)return T=c.nextPos,c.result;var d=A();if(null!==d)var e=d;else{if("A"===a.substr(T,1)){var g="A";T+=1}else{var g=null;U&&f('"A"')}if(null!==g)var e=g;else{if("B"===a.substr(T,1)){var h="B";T+=1}else{var h=null;U&&f('"B"')}if(null!==h)var e=h;else{if("C"===a.substr(T,1)){var i="C";T+=1}else{var i=null;U&&f('"C"')}if(null!==i)var e=i;else{if("D"===a.substr(T,1)){var j="D";T+=1}else{var j=null;U&&f('"D"')}if(null!==j)var e=j;else{if("E"===a.substr(T,1)){var k="E";T+=1}else{var k=null;U&&f('"E"')}if(null!==k)var e=k;else{if("F"===a.substr(T,1)){var l="F";T+=1}else{var l=null;U&&f('"F"')}if(null!==l)var e=l;else var e=null}}}}}}return X[b]={nextPos:T,result:e},e}function D(){var b="HTAB@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if("	"===a.substr(T,1)){var d="	";T+=1}else{var d=null;U&&f('"	"')}return X[b]={nextPos:T,result:d},d}function E(){var b="LF@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if("\n"===a.substr(T,1)){var d="\n";T+=1}else{var d=null;U&&f('"\\n"')}return X[b]={nextPos:T,result:d},d}function F(){var a="LWSP@"+T,b=X[a];if(b)return T=b.nextPos,b.result;var c=[],d=J();if(null!==d)var e=d;else{var f=T,g=y();if(null!==g){var h=J();if(null!==h)var i=[g,h];else{var i=null;T=f}}else{var i=null;T=f}if(null!==i)var e=i;else var e=null}for(;null!==e;){c.push(e);var d=J();if(null!==d)var e=d;else{var f=T,g=y();if(null!==g){var h=J();if(null!==h)var i=[g,h];else{var i=null;T=f}}else{var i=null;T=f}if(null!==i)var e=i;else var e=null}}return X[a]={nextPos:T,result:c},c}function G(){var b="OCTET@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if(null!==a.substr(T).match(/^[\0-\xFF]/)){var d=a.charAt(T);T++}else{var d=null;U&&f("[\\0-\\xFF]")}return X[b]={nextPos:T,result:d},d}function H(){var b="SP@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if(" "===a.substr(T,1)){var d=" ";T+=1}else{var d=null;U&&f('" "')}return X[b]={nextPos:T,result:d},d}function I(){var b="VCHAR@"+T,c=X[b];if(c)return T=c.nextPos,c.result;if(null!==a.substr(T).match(/^[!-~]/)){var d=a.charAt(T);T++}else{var d=null;U&&f("[!-~]")}return X[b]={nextPos:T,result:d},d}function J(){var a="WSP@"+T,b=X[a];if(b)return T=b.nextPos,b.result;var c=H();if(null!==c)var d=c;else{var e=D();if(null!==e)var d=e;else var d=null}return X[a]={nextPos:T,result:d},d}function K(){function b(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(W),d=Math.max(T,V),f=d<a.length?e(a.charAt(d)):"end of input";return"Expected "+c+" but "+f+" found."}function L(){for(var b=1,c=1,d=!1,e=0;V>e;e++){var f=a.charAt(e);"\n"===f?(d||b++,c=1,d=!1):"\r"===f|"\u2028"===f||"\u2029"===f?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}function M(a){return{type:"text",val:a}}function N(){return{type:"tag",name:"newpage"}}function O(a){return{type:"tag",name:"chapter",title:a}}function P(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function Q(a){return{type:"tag",name:"jump",pageNumber:a}}function R(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}var S={ALPHA:u,BIT:v,CHAR:w,CR:x,CRLF:y,CTL:z,DIGIT:A,DQUOTE:B,HEXDIG:C,HTAB:D,LF:E,LWSP:F,OCTET:G,SP:H,URI:s,VCHAR:I,WSP:J,chapterTitle:o,integer:r,jumpuriTitle:p,novel:g,numeric:q,tag:i,tagChapter:k,tagJump:m,tagJumpuri:n,tagNewpage:j,tagPixivimage:l,text:h,uri_chrs:t};if(void 0!==b){if(void 0===S[b])throw Error("Invalid rule name: "+e(b)+".")}else b="novel";var T=0,U=!0,V=0,W=[],X={},Y=S[b]();if(null===Y||T!==a.length){var Z=L();throw new this.SyntaxError(K(),Z.line,Z.column)}return Y},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}();b?module.exports=c:(a.PixivNovelParser=a.PixivNovelParser||{},a.PixivNovelParser.basicParser=c)}((this||0).self||global),function(a){var b="process"in a,c=function(){var a={parse:function(a,b){function c(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function d(a){var b=a.charCodeAt(0);if(255>=b)var d="x",e=2;else var d="u",e=4;return"\\"+d+c(b.toString(16).toUpperCase(),"0",e)}function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,d)+'"'}function f(a){aa>$||($>aa&&(aa=$,ba=[]),ba.push(a))}function g(){var a="novel@"+$,b=ca[a];if(b)return $=b.nextPos,b.result;var c=[],d=i();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}for(;null!==e;){c.push(e);var d=i();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}}return ca[a]={nextPos:$,result:c},c}function h(){var b="text@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$;if(null!==a.substr($).match(/^[^[]/)){var e=a.charAt($);$++}else{var e=null;_&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr($).match(/^[^[]/)){var e=a.charAt($);$++}else{var e=null;_&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var j=$,k=$,l=_;_=!1;var m=$,n=_;_=!1;var o=i();if(_=n,null===o)var p="";else{var p=null;$=m}if(_=l,null!==p){var q="";$=k}else var q=null;if(null!==q){if("["===a.substr($,1)){var r="[";$+=1}else{var r=null;_&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;$=j}}else{var s=null;$=j}if(null!==s)var h=s;else var h=null}if(null!==h)for(var t=[];null!==h;){if(t.push(h),null!==a.substr($).match(/^[^[]/)){var e=a.charAt($);$++}else{var e=null;_&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr($).match(/^[^[]/)){var e=a.charAt($);$++}else{var e=null;_&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var j=$,k=$,l=_;_=!1;var m=$,n=_;_=!1;var o=i();if(_=n,null===o)var p="";else{var p=null;$=m}if(_=l,null!==p){var q="";$=k}else var q=null;if(null!==q){if("["===a.substr($,1)){var r="[";$+=1}else{var r=null;_&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;$=j}}else{var s=null;$=j}if(null!==s)var h=s;else var h=null}}else var t=null;var u=null!==t?function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].join("");return Q(b)}(t):null;if(null!==u)var v=u;else{var v=null;$=d}return ca[b]={nextPos:$,result:v},v}function i(){var a="tag@"+$,b=ca[a];if(b)return $=b.nextPos,b.result;var c=j();if(null!==c)var d=c;else{var e=k();if(null!==e)var d=e;else{var f=l();if(null!==f)var d=f;else{var g=m();if(null!==g)var d=g;else{var h=n();if(null!==h)var d=h;else{var i=u();if(null!==i)var d=i;else{var o=v();if(null!==o)var d=o;else{var p=w();if(null!==p)var d=p;else var d=null}}}}}}}return ca[a]={nextPos:$,result:d},d}function j(){var b="tagNewpage@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$;if("[newpage]"===a.substr($,9)){var g="[newpage]";$+=9}else{var g=null;_&&f('"[newpage]"')}if(null!==g){var h=B();if(null!==h)var i=h;else{var j=I();if(null!==j)var i=j;else var i=null}var k=null!==i?i:"";if(null!==k)var l=[g,k];else{var l=null;$=e}}else{var l=null;$=e}var m=null!==l?function(){return R()}():null;if(null!==m)var n=m;else{var n=null;$=d}return ca[b]={nextPos:$,result:n},n}function k(){var b="tagChapter@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$;if("[chapter:"===a.substr($,9)){var g="[chapter:";$+=9}else{var g=null;_&&f('"[chapter:"')}if(null!==g){var h=o();if(null!==h){if("]"===a.substr($,1)){var i="]";$+=1}else{var i=null;_&&f('"]"')}if(null!==i){var j=B();if(null!==j)var k=j;else{var l=I();if(null!==l)var k=l;else var k=null}var m=null!==k?k:"";if(null!==m)var n=[g,h,i,m];else{var n=null;$=e}}else{var n=null;$=e}}else{var n=null;$=e}}else{var n=null;$=e}var p=null!==n?function(a){return S(a)}(n[1]):null;if(null!==p)var q=p;else{var q=null;$=d}return ca[b]={nextPos:$,result:q},q}function l(){var b="tagPixivimage@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$;if("[pixivimage:"===a.substr($,12)){var g="[pixivimage:";$+=12}else{var g=null;_&&f('"[pixivimage:"')}if(null!==g){var h=q();if(null!==h){var i=$;if("-"===a.substr($,1)){var j="-";$+=1}else{var j=null;_&&f('"-"')}if(null!==j){var k=r();if(null!==k)var l=[j,k];else{var l=null;$=i}}else{var l=null;$=i}var m=null!==l?l:"";if(null!==m){if("]"===a.substr($,1)){var n="]";$+=1}else{var n=null;_&&f('"]"')}if(null!==n)var o=[g,h,m,n];else{var o=null;$=e}}else{var o=null;$=e}}else{var o=null;$=e}}else{var o=null;$=e}var p=null!==o?function(a,b){return T(a,b&&b[1])}(o[1],o[2]):null;if(null!==p)var s=p;else{var s=null;$=d}return ca[b]={nextPos:$,result:s},s}function m(){var b="tagJump@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$;if("[jump:"===a.substr($,6)){var g="[jump:";$+=6}else{var g=null;_&&f('"[jump:"')}if(null!==g){var h=r();if(null!==h){if("]"===a.substr($,1)){var i="]";$+=1}else{var i=null;_&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;$=e}}else{var j=null;$=e}}else{var j=null;$=e}var k=null!==j?function(a){return U(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;$=d}return ca[b]={nextPos:$,result:l},l}function n(){var b="tagJumpuri@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$;if("[[jumpuri:"===a.substr($,10)){var g="[[jumpuri:";$+=10}else{var g=null;_&&f('"[[jumpuri:"')}if(null!==g){var h=p();if(null!==h){if(">"===a.substr($,1)){var i=">";$+=1}else{var i=null;_&&f('">"')}if(null!==i){for(var j=[],k=N();null!==k;){j.push(k);var k=N()}if(null!==j){var l=s();if(null!==l){for(var m=[],n=N();null!==n;){m.push(n);var n=N()}if(null!==m){if("]]"===a.substr($,2)){var o="]]";$+=2}else{var o=null;_&&f('"]]"')}if(null!==o)var q=[g,h,i,j,l,m,o];else{var q=null;$=e}}else{var q=null;$=e}}else{var q=null;$=e}}else{var q=null;$=e}}else{var q=null;$=e}}else{var q=null;$=e}}else{var q=null;$=e}var r=null!==q?function(a,b){return V(a,b)}(q[1],q[4]):null;if(null!==r)var t=r;else{var t=null;$=d}return ca[b]={nextPos:$,result:t},t}function o(){var b="chapterTitle@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=[];if(null!==a.substr($).match(/^[^\]]/)){var g=a.charAt($);$++}else{var g=null;_&&f("[^\\]]")}for(;null!==g;)if(e.push(g),null!==a.substr($).match(/^[^\]]/)){var g=a.charAt($);$++}else{var g=null;_&&f("[^\\]]")}var h=null!==e?function(a){return a.join("").trim()}(e):null;if(null!==h)var i=h;else{var i=null;$=d}return ca[b]={nextPos:$,result:i},i}function p(){var b="jumpuriTitle@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=[];if(null!==a.substr($).match(/^[^>]/)){var g=a.charAt($);$++}else{var g=null;_&&f("[^>]")}for(;null!==g;)if(e.push(g),null!==a.substr($).match(/^[^>]/)){var g=a.charAt($);$++}else{var g=null;_&&f("[^>]")}var h=null!==e?function(a){return a.join("").trim()}(e):null;if(null!==h)var i=h;else{var i=null;$=d}return ca[b]={nextPos:$,result:i},i}function q(){var a="numeric@"+$,b=ca[a];if(b)return $=b.nextPos,b.result;var c=$,d=E();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=E()}else var e=null;var f=null!==e?function(a){return a.join("")}(e):null;if(null!==f)var g=f;else{var g=null;$=c}return ca[a]={nextPos:$,result:g},g}function r(){var a="integer@"+$,b=ca[a];if(b)return $=b.nextPos,b.result;var c=$,d=E();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=E()}else var e=null;var f=null!==e?function(a){return parseInt(a.join(""),10)}(e):null;if(null!==f)var g=f;else{var g=null;$=c}return ca[a]={nextPos:$,result:g},g}function s(){var b="URI@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$,g=$;if("http"===a.substr($,4)){var h="http";$+=4}else{var h=null;_&&f('"http"')}if(null!==h){if("s"===a.substr($,1)){var i="s";$+=1}else{var i=null;_&&f('"s"')}var j=null!==i?i:"";if(null!==j){if("://"===a.substr($,3)){var k="://";$+=3}else{var k=null;_&&f('"://"')}if(null!==k)var l=[h,j,k];else{var l=null;$=g}}else{var l=null;$=g}}else{var l=null;$=g}if(null!==l){for(var m=[],n=t();null!==n;){m.push(n);var n=t()}if(null!==m)var o=[l,m];else{var o=null;$=e}}else{var o=null;$=e}var p=null!==o?function(a,b){return a.join("")+b.join("")}(o[0],o[1]):null;if(null!==p)var q=p;else{var q=null;$=d}return ca[b]={nextPos:$,result:q},q}function t(){var b="uri_chrs@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=y();if(null!==d)var e=d;else{var g=E();if(null!==g)var e=g;else{var h=$;if("%"===a.substr($,1)){var i="%";$+=1}else{var i=null;_&&f('"%"')}if(null!==i){var j=G();if(null!==j)for(var k=[];null!==j;){k.push(j);var j=G()}else var k=null;if(null!==k)var l=[i,k];else{var l=null;$=h}}else{var l=null;$=h}if(null!==l)var e=l;else{if(null!==a.substr($).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var m=a.charAt($);$++}else{var m=null;_&&f("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==m)var e=m;else var e=null}}}return ca[b]={nextPos:$,result:e},e}function u(){var b="tagRuby@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$;if("[ruby:"===a.substr($,6)){var g="[ruby:";$+=6}else{var g=null;_&&f('"[ruby:"')}if(null!==g){var h=[];if(null!==a.substr($).match(/^[^>]/)){var i=a.charAt($);$++}else{var i=null;_&&f("[^>]")}for(;null!==i;)if(h.push(i),null!==a.substr($).match(/^[^>]/)){var i=a.charAt($);$++}else{var i=null;_&&f("[^>]")}if(null!==h){if(">"===a.substr($,1)){var j=">";$+=1}else{var j=null;_&&f('">"')}if(null!==j){var k=[];if(null!==a.substr($).match(/^[^\]]/)){var l=a.charAt($);$++}else{var l=null;_&&f("[^\\]]")}for(;null!==l;)if(k.push(l),null!==a.substr($).match(/^[^\]]/)){var l=a.charAt($);$++}else{var l=null;_&&f("[^\\]]")}if(null!==k){if("]"===a.substr($,1)){var m="]";$+=1}else{var m=null;_&&f('"]"')}if(null!==m)var n=[g,h,j,k,m];else{var n=null;$=e}}else{var n=null;$=e}}else{var n=null;$=e}}else{var n=null;$=e}}else{var n=null;$=e}var o=null!==n?function(a,b){return W(a.join("").trim(),b.join("").trim())}(n[1],n[3]):null;if(null!==o)var p=o;else{var p=null;$=d}return ca[b]={nextPos:$,result:p},p}function v(){var b="tagEmoji@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$;if("[emoji:"===a.substr($,7)){var g="[emoji:";$+=7}else{var g=null;_&&f('"[emoji:"')}if(null!==g){var h=x();if(null!==h){if("]"===a.substr($,1)){var i="]";$+=1}else{var i=null;_&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;$=e}}else{var j=null;$=e}}else{var j=null;$=e}var k=null!==j?function(a){return X(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;$=d}return ca[b]={nextPos:$,result:l},l}function w(){var b="tagStrong@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=$;if("[strong:"===a.substr($,8)){var g="[strong:";$+=8}else{var g=null;_&&f('"[strong:"')}if(null!==g){var h=[];if(null!==a.substr($).match(/^[^\]]/)){var i=a.charAt($);$++}else{var i=null;_&&f("[^\\]]")}for(;null!==i;)if(h.push(i),null!==a.substr($).match(/^[^\]]/)){var i=a.charAt($);$++}else{var i=null;_&&f("[^\\]]")}if(null!==h){if("]"===a.substr($,1)){var j="]";$+=1}else{var j=null;_&&f('"]"')}if(null!==j)var k=[g,h,j];else{var k=null;$=e}}else{var k=null;$=e}}else{var k=null;$=e}var l=null!==k?function(a){return Y(a.join("").trim())}(k[1]):null;if(null!==l)var m=l;else{var m=null;$=d}return ca[b]={nextPos:$,result:m},m}function x(){var b="emojiName@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=$,e=y();if(null!==e)var g=e;else{var h=E();if(null!==h)var g=h;else{if("-"===a.substr($,1)){var i="-";$+=1}else{var i=null;_&&f('"-"')}if(null!==i)var g=i;else var g=null}}if(null!==g)for(var j=[];null!==g;){j.push(g);var e=y();if(null!==e)var g=e;else{var h=E();if(null!==h)var g=h;else{if("-"===a.substr($,1)){var i="-";$+=1}else{var i=null;_&&f('"-"')}if(null!==i)var g=i;else var g=null}}}else var j=null;var k=null!==j?function(a){return a.join("").trim()}(j):null;if(null!==k)var l=k;else{var l=null;$=d}return ca[b]={nextPos:$,result:l},l}function y(){var b="ALPHA@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if(null!==a.substr($).match(/^[A-Z]/)){var d=a.charAt($);$++}else{var d=null;_&&f("[A-Z]")}if(null!==d)var e=d;else{if(null!==a.substr($).match(/^[a-z]/)){var g=a.charAt($);$++}else{var g=null;_&&f("[a-z]")}if(null!==g)var e=g;else var e=null}return ca[b]={nextPos:$,result:e},e}function z(){var b="BIT@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if("0"===a.substr($,1)){var d="0";$+=1}else{var d=null;_&&f('"0"')}if(null!==d)var e=d;else{if("1"===a.substr($,1)){var g="1";$+=1}else{var g=null;_&&f('"1"')}if(null!==g)var e=g;else var e=null}return ca[b]={nextPos:$,result:e},e}function A(){var b="CHAR@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if(null!==a.substr($).match(/^[-]/)){var d=a.charAt($);$++}else{var d=null;_&&f("[-]")}return ca[b]={nextPos:$,result:d},d}function B(){var b="CR@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if("\r"===a.substr($,1)){var d="\r";$+=1}else{var d=null;_&&f('"\\r"')}return ca[b]={nextPos:$,result:d},d}function C(){var a="CRLF@"+$,b=ca[a];if(b)return $=b.nextPos,b.result;var c=$,d=B();if(null!==d){var e=I();if(null!==e)var f=[d,e];else{var f=null;$=c}}else{var f=null;$=c}return ca[a]={nextPos:$,result:f},f}function D(){var b="CTL@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if(null!==a.substr($).match(/^[\0-]/)){var d=a.charAt($);$++}else{var d=null;_&&f("[\\0-]")}if(null!==d)var e=d;else{if(""===a.substr($,1)){var g="";$+=1}else{var g=null;_&&f('""')}if(null!==g)var e=g;else var e=null}return ca[b]={nextPos:$,result:e},e}function E(){var b="DIGIT@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if(null!==a.substr($).match(/^[0-9]/)){var d=a.charAt($);$++}else{var d=null;_&&f("[0-9]")}return ca[b]={nextPos:$,result:d},d}function F(){var b="DQUOTE@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if(null!==a.substr($).match(/^["]/)){var d=a.charAt($);$++}else{var d=null;_&&f('["]')}return ca[b]={nextPos:$,result:d},d}function G(){var b="HEXDIG@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;var d=E();if(null!==d)var e=d;else{if("A"===a.substr($,1)){var g="A";$+=1}else{var g=null;_&&f('"A"')}if(null!==g)var e=g;else{if("B"===a.substr($,1)){var h="B";$+=1}else{var h=null;_&&f('"B"')}if(null!==h)var e=h;else{if("C"===a.substr($,1)){var i="C";$+=1}else{var i=null;_&&f('"C"')}if(null!==i)var e=i;else{if("D"===a.substr($,1)){var j="D";$+=1}else{var j=null;_&&f('"D"')}if(null!==j)var e=j;else{if("E"===a.substr($,1)){var k="E";$+=1}else{var k=null;_&&f('"E"')}if(null!==k)var e=k;else{if("F"===a.substr($,1)){var l="F";$+=1}else{var l=null;_&&f('"F"')}if(null!==l)var e=l;else var e=null}}}}}}return ca[b]={nextPos:$,result:e},e}function H(){var b="HTAB@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if("	"===a.substr($,1)){var d="	";$+=1}else{var d=null;_&&f('"	"')}return ca[b]={nextPos:$,result:d},d}function I(){var b="LF@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if("\n"===a.substr($,1)){var d="\n";$+=1}else{var d=null;_&&f('"\\n"')}return ca[b]={nextPos:$,result:d},d}function J(){var a="LWSP@"+$,b=ca[a];if(b)return $=b.nextPos,b.result;var c=[],d=N();if(null!==d)var e=d;else{var f=$,g=C();if(null!==g){var h=N();if(null!==h)var i=[g,h];else{var i=null;$=f}}else{var i=null;$=f}if(null!==i)var e=i;else var e=null}for(;null!==e;){c.push(e);var d=N();if(null!==d)var e=d;else{var f=$,g=C();if(null!==g){var h=N();if(null!==h)var i=[g,h];else{var i=null;$=f}}else{var i=null;$=f}if(null!==i)var e=i;else var e=null}}return ca[a]={nextPos:$,result:c},c}function K(){var b="OCTET@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if(null!==a.substr($).match(/^[\0-\xFF]/)){var d=a.charAt($);$++}else{var d=null;_&&f("[\\0-\\xFF]")}return ca[b]={nextPos:$,result:d},d}function L(){var b="SP@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if(" "===a.substr($,1)){var d=" ";$+=1}else{var d=null;_&&f('" "')}return ca[b]={nextPos:$,result:d},d}function M(){var b="VCHAR@"+$,c=ca[b];if(c)return $=c.nextPos,c.result;if(null!==a.substr($).match(/^[!-~]/)){var d=a.charAt($);$++}else{var d=null;_&&f("[!-~]")}return ca[b]={nextPos:$,result:d},d}function N(){var a="WSP@"+$,b=ca[a];if(b)return $=b.nextPos,b.result;var c=L();if(null!==c)var d=c;else{var e=H();if(null!==e)var d=e;else var d=null}return ca[a]={nextPos:$,result:d},d}function O(){function b(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(ba),d=Math.max($,aa),f=d<a.length?e(a.charAt(d)):"end of input";return"Expected "+c+" but "+f+" found."}function P(){for(var b=1,c=1,d=!1,e=0;aa>e;e++){var f=a.charAt(e);"\n"===f?(d||b++,c=1,d=!1):"\r"===f|"\u2028"===f||"\u2029"===f?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}function Q(a){return{type:"text",val:a}}function R(){return{type:"tag",name:"newpage"}}function S(a){return{type:"tag",name:"chapter",title:a}}function T(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function U(a){return{type:"tag",name:"jump",pageNumber:a}}function V(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}function W(a,b){return{type:"tag",name:"ruby",rubyBase:a,rubyText:b}}function X(a){return{type:"tag",name:"emoji",emojiName:a}}function Y(a){return{type:"tag",name:"strong",val:a}}var Z={ALPHA:y,BIT:z,CHAR:A,CR:B,CRLF:C,CTL:D,DIGIT:E,DQUOTE:F,HEXDIG:G,HTAB:H,LF:I,LWSP:J,OCTET:K,SP:L,URI:s,VCHAR:M,WSP:N,chapterTitle:o,emojiName:x,integer:r,jumpuriTitle:p,novel:g,numeric:q,tag:i,tagChapter:k,tagEmoji:v,tagJump:m,tagJumpuri:n,tagNewpage:j,tagPixivimage:l,tagRuby:u,tagStrong:w,text:h,uri_chrs:t};if(void 0!==b){if(void 0===Z[b])throw Error("Invalid rule name: "+e(b)+".")}else b="novel";var $=0,_=!0,aa=0,ba=[],ca={},da=Z[b]();if(null===da||$!==a.length){var ea=P();throw new this.SyntaxError(O(),ea.line,ea.column)}return da},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}();b?module.exports=c:(a.PixivNovelParser=a.PixivNovelParser||{},
a.PixivNovelParser.extendedParser=c)}((this||0).self||global),function(a){"use strict";function b(a){a=a||{},this.syntax=a.syntax||"basic",this.tree=[]}var c,d,e="process"in a;e?(c=require("./parser.peg.js"),d=require("./parser-extended.peg.js")):(c=PixivNovelParser.basicParser,d=PixivNovelParser.extendedParser),b.parse=function(a,b){b=b||{},b.syntax=b.syntax||"basic";try{switch(a=a.replace(/\r?\n/g,"\n").replace(/[\s\u200c]/g,function(a){return"\n"===a||"　"===a?a:" "}),b.syntax){case"extended":return d.parse(a);case"basic":default:return c.parse(a)}}catch(e){return console.error(e),[{type:"text",val:a}]}},b.prototype.parse=function(a){return this.tree=b.parse(a,{syntax:this.syntax}),this},b.prototype.toJSON=function(){return JSON.stringify(this.tree)},e?module.exports={Parser:b}:(a.PixivNovelParser=a.PixivNovalPerser||{},a.PixivNovelParser.Parser=b)}((this||0).self||global),function(a){"use strict";var b="process"in a;b?module.exports=require("./parser"):a.PixivNovelParser=a.PixivNovelParser||{}}((this||0).self||global);
//# sourceMappingURL=pixiv-novel-parser.min.js.map