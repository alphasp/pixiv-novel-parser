!function(a){var b="process"in a,c=function(){var a={parse:function(a,b){function c(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function d(a){var b=a.charCodeAt(0);if(255>=b)var d="x",e=2;else var d="u",e=4;return"\\"+d+c(b.toString(16).toUpperCase(),"0",e)}function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,d)+'"'}function f(a){da>ba||(ba>da&&(da=ba,ea=[]),ea.push(a))}function g(){var a="novel@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=[],d=o();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}for(;null!==e;){c.push(e);var d=o();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}}return fa[a]={nextPos:ba,result:c},c}function h(){var b="text@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba;if(null!==a.substr(ba).match(/^[^[]/)){var e=a.charAt(ba);ba++}else{var e=null;ca&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ba).match(/^[^[]/)){var e=a.charAt(ba);ba++}else{var e=null;ca&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var i=ba,j=ba,k=ca;ca=!1;var l=ba,m=ca;ca=!1;var n=o();if(ca=m,null===n)var p="";else{var p=null;ba=l}if(ca=k,null!==p){var q="";ba=j}else var q=null;if(null!==q){if("["===a.substr(ba,1)){var r="[";ba+=1}else{var r=null;ca&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;ba=i}}else{var s=null;ba=i}if(null!==s)var h=s;else var h=null}if(null!==h)for(var t=[];null!==h;){if(t.push(h),null!==a.substr(ba).match(/^[^[]/)){var e=a.charAt(ba);ba++}else{var e=null;ca&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ba).match(/^[^[]/)){var e=a.charAt(ba);ba++}else{var e=null;ca&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var i=ba,j=ba,k=ca;ca=!1;var l=ba,m=ca;ca=!1;var n=o();if(ca=m,null===n)var p="";else{var p=null;ba=l}if(ca=k,null!==p){var q="";ba=j}else var q=null;if(null!==q){if("["===a.substr(ba,1)){var r="[";ba+=1}else{var r=null;ca&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;ba=i}}else{var s=null;ba=i}if(null!==s)var h=s;else var h=null}}else var t=null;var u=null!==t?function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].join("");return V(b)}(t):null;if(null!==u)var v=u;else{var v=null;ba=d}return fa[b]={nextPos:ba,result:v},v}function i(){var b="inlineText@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba;if(null!==a.substr(ba).match(/^[^[\]]/)){var e=a.charAt(ba);ba++}else{var e=null;ca&&f("[^[\\]]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ba).match(/^[^[\]]/)){var e=a.charAt(ba);ba++}else{var e=null;ca&&f("[^[\\]]")}else var g=null;if(null!==g)var h=g;else{var i=ba,j=ba,k=ca;ca=!1;var l=ba,m=ca;ca=!1;var n=A();if(ca=m,null===n)var o="";else{var o=null;ba=l}if(ca=k,null!==o){var p="";ba=j}else var p=null;if(null!==p){if("["===a.substr(ba,1)){var q="[";ba+=1}else{var q=null;ca&&f('"["')}if(null!==q)var r=[p,q];else{var r=null;ba=i}}else{var r=null;ba=i}if(null!==r)var h=r;else var h=null}if(null!==h)for(var s=[];null!==h;){if(s.push(h),null!==a.substr(ba).match(/^[^[\]]/)){var e=a.charAt(ba);ba++}else{var e=null;ca&&f("[^[\\]]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ba).match(/^[^[\]]/)){var e=a.charAt(ba);ba++}else{var e=null;ca&&f("[^[\\]]")}else var g=null;if(null!==g)var h=g;else{var i=ba,j=ba,k=ca;ca=!1;var l=ba,m=ca;ca=!1;var n=A();if(ca=m,null===n)var o="";else{var o=null;ba=l}if(ca=k,null!==o){var p="";ba=j}else var p=null;if(null!==p){if("["===a.substr(ba,1)){var q="[";ba+=1}else{var q=null;ca&&f('"["')}if(null!==q)var r=[p,q];else{var r=null;ba=i}}else{var r=null;ba=i}if(null!==r)var h=r;else var h=null}}else var s=null;var t=null!==s?function(a){return V(U(T(a).join("")))}(s):null;if(null!==t)var u=t;else{var u=null;ba=d}return fa[b]={nextPos:ba,result:u},u}function j(){var a="inlineToken@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=A();if(null!==c)var d=c;else{var e=i();if(null!==e)var d=e;else var d=null}return fa[a]={nextPos:ba,result:d},d}function k(){var a="inlineTokens@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=j();if(null!==c)for(var d=[];null!==c;){d.push(c);var c=j()}else var d=null;return fa[a]={nextPos:ba,result:d},d}function l(){var b="inlineInlineText@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=ba;if(null!==a.substr(ba).match(/^[^[>]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[^[>]")}if(null!==g)for(var h=[];null!==g;)if(h.push(g),null!==a.substr(ba).match(/^[^[>]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[^[>]")}else var h=null;if(null!==h){var i=ba,j=ca;ca=!1;var k=ba,l=ca;if(ca=!1,"]]"===a.substr(ba,2)){var m="]]";ba+=2}else{var m=null;ca&&f('"]]"')}if(ca=l,null===m)var n="";else{var n=null;ba=k}if(ca=j,null!==n){var o="";ba=i}else var o=null;if(null!==o)var p=[h,o];else{var p=null;ba=e}}else{var p=null;ba=e}if(null!==p)var q=p;else{var r=ba,s=ba,t=ca;ca=!1;var u=ba,v=ca;ca=!1;var w=A();if(ca=v,null===w)var x="";else{var x=null;ba=u}if(ca=t,null!==x){var y="";ba=s}else var y=null;if(null!==y){if("["===a.substr(ba,1)){var z="[";ba+=1}else{var z=null;ca&&f('"["')}if(null!==z)var B=[y,z];else{var B=null;ba=r}}else{var B=null;ba=r}if(null!==B)var q=B;else var q=null}if(null!==q)for(var C=[];null!==q;){C.push(q);var e=ba;if(null!==a.substr(ba).match(/^[^[>]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[^[>]")}if(null!==g)for(var h=[];null!==g;)if(h.push(g),null!==a.substr(ba).match(/^[^[>]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[^[>]")}else var h=null;if(null!==h){var i=ba,j=ca;ca=!1;var k=ba,l=ca;if(ca=!1,"]]"===a.substr(ba,2)){var m="]]";ba+=2}else{var m=null;ca&&f('"]]"')}if(ca=l,null===m)var n="";else{var n=null;ba=k}if(ca=j,null!==n){var o="";ba=i}else var o=null;if(null!==o)var p=[h,o];else{var p=null;ba=e}}else{var p=null;ba=e}if(null!==p)var q=p;else{var r=ba,s=ba,t=ca;ca=!1;var u=ba,v=ca;ca=!1;var w=A();if(ca=v,null===w)var x="";else{var x=null;ba=u}if(ca=t,null!==x){var y="";ba=s}else var y=null;if(null!==y){if("["===a.substr(ba,1)){var z="[";ba+=1}else{var z=null;ca&&f('"["')}if(null!==z)var B=[y,z];else{var B=null;ba=r}}else{var B=null;ba=r}if(null!==B)var q=B;else var q=null}}else var C=null;var D=null!==C?function(a){return V(U(T(a).join("")))}(C):null;if(null!==D)var E=D;else{var E=null;ba=d}return fa[b]={nextPos:ba,result:E},E}function m(){var a="inlineInlineToken@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=A();if(null!==c)var d=c;else{var e=l();if(null!==e)var d=e;else var d=null}return fa[a]={nextPos:ba,result:d},d}function n(){var a="inlineInlineTokens@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=m();if(null!==c)for(var d=[];null!==c;){d.push(c);var c=m()}else var d=null;return fa[a]={nextPos:ba,result:d},d}function o(){var a="tag@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=p();if(null!==c)var d=c;else{var e=q();if(null!==e)var d=e;else{var f=r();if(null!==f)var d=f;else{var g=s();if(null!==g)var d=g;else{var h=t();if(null!==h)var d=h;else{var i=A();if(null!==i)var d=i;else var d=null}}}}}return fa[a]={nextPos:ba,result:d},d}function p(){var b="tagNewpage@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=ba;if("[newpage]"===a.substr(ba,9)){var g="[newpage]";ba+=9}else{var g=null;ca&&f('"[newpage]"')}if(null!==g){var h=E();if(null!==h)var i=h;else{var j=L();if(null!==j)var i=j;else var i=null}var k=null!==i?i:"";if(null!==k)var l=[g,k];else{var l=null;ba=e}}else{var l=null;ba=e}var m=null!==l?function(){return W()}():null;if(null!==m)var n=m;else{var n=null;ba=d}return fa[b]={nextPos:ba,result:n},n}function q(){var b="tagChapter@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=ba;if("[chapter:"===a.substr(ba,9)){var g="[chapter:";ba+=9}else{var g=null;ca&&f('"[chapter:"')}if(null!==g){var h=k();if(null!==h){if("]"===a.substr(ba,1)){var i="]";ba+=1}else{var i=null;ca&&f('"]"')}if(null!==i){var j=E();if(null!==j)var l=j;else{var m=L();if(null!==m)var l=m;else var l=null}var n=null!==l?l:"";if(null!==n)var o=[g,h,i,n];else{var o=null;ba=e}}else{var o=null;ba=e}}else{var o=null;ba=e}}else{var o=null;ba=e}var p=null!==o?function(a){return X(a)}(o[1]):null;if(null!==p)var q=p;else{var q=null;ba=d}return fa[b]={nextPos:ba,result:q},q}function r(){var b="tagPixivimage@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=ba;if("[pixivimage:"===a.substr(ba,12)){var g="[pixivimage:";ba+=12}else{var g=null;ca&&f('"[pixivimage:"')}if(null!==g){var h=w();if(null!==h){var i=ba;if("-"===a.substr(ba,1)){var j="-";ba+=1}else{var j=null;ca&&f('"-"')}if(null!==j){var k=x();if(null!==k)var l=[j,k];else{var l=null;ba=i}}else{var l=null;ba=i}var m=null!==l?l:"";if(null!==m){if("]"===a.substr(ba,1)){var n="]";ba+=1}else{var n=null;ca&&f('"]"')}if(null!==n)var o=[g,h,m,n];else{var o=null;ba=e}}else{var o=null;ba=e}}else{var o=null;ba=e}}else{var o=null;ba=e}var p=null!==o?function(a,b){return Y(a,b&&b[1])}(o[1],o[2]):null;if(null!==p)var q=p;else{var q=null;ba=d}return fa[b]={nextPos:ba,result:q},q}function s(){var b="tagJump@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=ba;if("[jump:"===a.substr(ba,6)){var g="[jump:";ba+=6}else{var g=null;ca&&f('"[jump:"')}if(null!==g){var h=x();if(null!==h){if("]"===a.substr(ba,1)){var i="]";ba+=1}else{var i=null;ca&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;ba=e}}else{var j=null;ba=e}}else{var j=null;ba=e}var k=null!==j?function(a){return Z(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;ba=d}return fa[b]={nextPos:ba,result:l},l}function t(){var b="tagJumpuri@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=ba;if("[[jumpuri:"===a.substr(ba,10)){var g="[[jumpuri:";ba+=10}else{var g=null;ca&&f('"[[jumpuri:"')}if(null!==g){var h=n();if(null!==h){if(">"===a.substr(ba,1)){var i=">";ba+=1}else{var i=null;ca&&f('">"')}if(null!==i){for(var j=[],k=Q();null!==k;){j.push(k);var k=Q()}if(null!==j){var l=y();if(null!==l){for(var m=[],o=Q();null!==o;){m.push(o);var o=Q()}if(null!==m){if("]]"===a.substr(ba,2)){var p="]]";ba+=2}else{var p=null;ca&&f('"]]"')}if(null!==p)var q=[g,h,i,j,l,m,p];else{var q=null;ba=e}}else{var q=null;ba=e}}else{var q=null;ba=e}}else{var q=null;ba=e}}else{var q=null;ba=e}}else{var q=null;ba=e}}else{var q=null;ba=e}var r=null!==q?function(a,b){return $(a,b)}(q[1],q[4]):null;if(null!==r)var s=r;else{var s=null;ba=d}return fa[b]={nextPos:ba,result:s},s}function u(){var b="chapterTitle@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=[];if(null!==a.substr(ba).match(/^[^\]]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[^\\]]")}for(;null!==g;)if(e.push(g),null!==a.substr(ba).match(/^[^\]]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[^\\]]")}var h=null!==e?function(a){return U(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;ba=d}return fa[b]={nextPos:ba,result:i},i}function v(){var b="jumpuriTitle@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=[];if(null!==a.substr(ba).match(/^[^>]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[^>]")}for(;null!==g;)if(e.push(g),null!==a.substr(ba).match(/^[^>]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[^>]")}var h=null!==e?function(a){return U(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;ba=d}return fa[b]={nextPos:ba,result:i},i}function w(){var a="numeric@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=ba,d=H();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=H()}else var e=null;var f=null!==e?function(a){return a.join("")}(e):null;if(null!==f)var g=f;else{var g=null;ba=c}return fa[a]={nextPos:ba,result:g},g}function x(){var a="integer@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=ba,d=H();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=H()}else var e=null;var f=null!==e?function(a){return parseInt(a.join(""),10)}(e):null;if(null!==f)var g=f;else{var g=null;ba=c}return fa[a]={nextPos:ba,result:g},g}function y(){var b="URI@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=ba,g=ba;if("http"===a.substr(ba,4)){var h="http";ba+=4}else{var h=null;ca&&f('"http"')}if(null!==h){if("s"===a.substr(ba,1)){var i="s";ba+=1}else{var i=null;ca&&f('"s"')}var j=null!==i?i:"";if(null!==j){if("://"===a.substr(ba,3)){var k="://";ba+=3}else{var k=null;ca&&f('"://"')}if(null!==k)var l=[h,j,k];else{var l=null;ba=g}}else{var l=null;ba=g}}else{var l=null;ba=g}if(null!==l){for(var m=[],n=z();null!==n;){m.push(n);var n=z()}if(null!==m)var o=[l,m];else{var o=null;ba=e}}else{var o=null;ba=e}var p=null!==o?function(a,b){return a.join("")+b.join("")}(o[0],o[1]):null;if(null!==p)var q=p;else{var q=null;ba=d}return fa[b]={nextPos:ba,result:q},q}function z(){var b="uri_chrs@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=B();if(null!==d)var e=d;else{var g=H();if(null!==g)var e=g;else{var h=ba;if("%"===a.substr(ba,1)){var i="%";ba+=1}else{var i=null;ca&&f('"%"')}if(null!==i){var j=J();if(null!==j)for(var k=[];null!==j;){k.push(j);var j=J()}else var k=null;if(null!==k)var l=[i,k];else{var l=null;ba=h}}else{var l=null;ba=h}if(null!==l)var e=l;else{if(null!==a.substr(ba).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var m=a.charAt(ba);ba++}else{var m=null;ca&&f("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==m)var e=m;else var e=null}}}return fa[b]={nextPos:ba,result:e},e}function A(){var b="tagRuby@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=ba,e=ba;if("[[ruby:"===a.substr(ba,7)){var g="[[ruby:";ba+=7}else{var g=null;ca&&f('"[[ruby:"')}if(null!==g){var h=[];if(null!==a.substr(ba).match(/^[^>]/)){var i=a.charAt(ba);ba++}else{var i=null;ca&&f("[^>]")}for(;null!==i;)if(h.push(i),null!==a.substr(ba).match(/^[^>]/)){var i=a.charAt(ba);ba++}else{var i=null;ca&&f("[^>]")}if(null!==h){if(">"===a.substr(ba,1)){var j=">";ba+=1}else{var j=null;ca&&f('">"')}if(null!==j){var k=[];if(null!==a.substr(ba).match(/^[^\]]/)){var l=a.charAt(ba);ba++}else{var l=null;ca&&f("[^\\]]")}if(null!==l)for(var m=[];null!==l;)if(m.push(l),null!==a.substr(ba).match(/^[^\]]/)){var l=a.charAt(ba);ba++}else{var l=null;ca&&f("[^\\]]")}else var m=null;if(null!==m)var n=m;else{var o=ba;if("]"===a.substr(ba,1)){var p="]";ba+=1}else{var p=null;ca&&f('"]"')}if(null!==p){var q=ba,r=ca;ca=!1;var s=ba,t=ca;if(ca=!1,"]"===a.substr(ba,1)){var u="]";ba+=1}else{var u=null;ca&&f('"]"')}if(ca=t,null===u)var v="";else{var v=null;ba=s}if(ca=r,null!==v){var w="";ba=q}else var w=null;if(null!==w)var x=[p,w];else{var x=null;ba=o}}else{var x=null;ba=o}if(null!==x)var n=x;else var n=null}for(;null!==n;){if(k.push(n),null!==a.substr(ba).match(/^[^\]]/)){var l=a.charAt(ba);ba++}else{var l=null;ca&&f("[^\\]]")}if(null!==l)for(var m=[];null!==l;)if(m.push(l),null!==a.substr(ba).match(/^[^\]]/)){var l=a.charAt(ba);ba++}else{var l=null;ca&&f("[^\\]]")}else var m=null;if(null!==m)var n=m;else{var o=ba;if("]"===a.substr(ba,1)){var p="]";ba+=1}else{var p=null;ca&&f('"]"')}if(null!==p){var q=ba,r=ca;ca=!1;var s=ba,t=ca;if(ca=!1,"]"===a.substr(ba,1)){var u="]";ba+=1}else{var u=null;ca&&f('"]"')}if(ca=t,null===u)var v="";else{var v=null;ba=s}if(ca=r,null!==v){var w="";ba=q}else var w=null;if(null!==w)var x=[p,w];else{var x=null;ba=o}}else{var x=null;ba=o}if(null!==x)var n=x;else var n=null}}if(null!==k){if("]]"===a.substr(ba,2)){var y="]]";ba+=2}else{var y=null;ca&&f('"]]"')}if(null!==y)var z=[g,h,j,k,y];else{var z=null;ba=e}}else{var z=null;ba=e}}else{var z=null;ba=e}}else{var z=null;ba=e}}else{var z=null;ba=e}var A=null!==z?function(a,b){return _(U(a.join("")),U(T(b).join("")))}(z[1],z[3]):null;if(null!==A)var B=A;else{var B=null;ba=d}return fa[b]={nextPos:ba,result:B},B}function B(){var b="ALPHA@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if(null!==a.substr(ba).match(/^[A-Z]/)){var d=a.charAt(ba);ba++}else{var d=null;ca&&f("[A-Z]")}if(null!==d)var e=d;else{if(null!==a.substr(ba).match(/^[a-z]/)){var g=a.charAt(ba);ba++}else{var g=null;ca&&f("[a-z]")}if(null!==g)var e=g;else var e=null}return fa[b]={nextPos:ba,result:e},e}function C(){var b="BIT@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if("0"===a.substr(ba,1)){var d="0";ba+=1}else{var d=null;ca&&f('"0"')}if(null!==d)var e=d;else{if("1"===a.substr(ba,1)){var g="1";ba+=1}else{var g=null;ca&&f('"1"')}if(null!==g)var e=g;else var e=null}return fa[b]={nextPos:ba,result:e},e}function D(){var b="CHAR@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if(null!==a.substr(ba).match(/^[-]/)){var d=a.charAt(ba);ba++}else{var d=null;ca&&f("[-]")}return fa[b]={nextPos:ba,result:d},d}function E(){var b="CR@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if("\r"===a.substr(ba,1)){var d="\r";ba+=1}else{var d=null;ca&&f('"\\r"')}return fa[b]={nextPos:ba,result:d},d}function F(){var a="CRLF@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=ba,d=E();if(null!==d){var e=L();if(null!==e)var f=[d,e];else{var f=null;ba=c}}else{var f=null;ba=c}return fa[a]={nextPos:ba,result:f},f}function G(){var b="CTL@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if(null!==a.substr(ba).match(/^[\0-]/)){var d=a.charAt(ba);ba++}else{var d=null;ca&&f("[\\0-]")}if(null!==d)var e=d;else{if(""===a.substr(ba,1)){var g="";ba+=1}else{var g=null;ca&&f('""')}if(null!==g)var e=g;else var e=null}return fa[b]={nextPos:ba,result:e},e}function H(){var b="DIGIT@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if(null!==a.substr(ba).match(/^[0-9]/)){var d=a.charAt(ba);ba++}else{var d=null;ca&&f("[0-9]")}return fa[b]={nextPos:ba,result:d},d}function I(){var b="DQUOTE@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if(null!==a.substr(ba).match(/^["]/)){var d=a.charAt(ba);ba++}else{var d=null;ca&&f('["]')}return fa[b]={nextPos:ba,result:d},d}function J(){var b="HEXDIG@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;var d=H();if(null!==d)var e=d;else{if("A"===a.substr(ba,1)){var g="A";ba+=1}else{var g=null;ca&&f('"A"')}if(null!==g)var e=g;else{if("B"===a.substr(ba,1)){var h="B";ba+=1}else{var h=null;ca&&f('"B"')}if(null!==h)var e=h;else{if("C"===a.substr(ba,1)){var i="C";ba+=1}else{var i=null;ca&&f('"C"')}if(null!==i)var e=i;else{if("D"===a.substr(ba,1)){var j="D";ba+=1}else{var j=null;ca&&f('"D"')}if(null!==j)var e=j;else{if("E"===a.substr(ba,1)){var k="E";ba+=1}else{var k=null;ca&&f('"E"')}if(null!==k)var e=k;else{if("F"===a.substr(ba,1)){var l="F";ba+=1}else{var l=null;ca&&f('"F"')}if(null!==l)var e=l;else var e=null}}}}}}return fa[b]={nextPos:ba,result:e},e}function K(){var b="HTAB@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if("	"===a.substr(ba,1)){var d="	";ba+=1}else{var d=null;ca&&f('"	"')}return fa[b]={nextPos:ba,result:d},d}function L(){var b="LF@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if("\n"===a.substr(ba,1)){var d="\n";ba+=1}else{var d=null;ca&&f('"\\n"')}return fa[b]={nextPos:ba,result:d},d}function M(){var a="LWSP@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=[],d=Q();if(null!==d)var e=d;else{var f=ba,g=F();if(null!==g){var h=Q();if(null!==h)var i=[g,h];else{var i=null;ba=f}}else{var i=null;ba=f}if(null!==i)var e=i;else var e=null}for(;null!==e;){c.push(e);var d=Q();if(null!==d)var e=d;else{var f=ba,g=F();if(null!==g){var h=Q();if(null!==h)var i=[g,h];else{var i=null;ba=f}}else{var i=null;ba=f}if(null!==i)var e=i;else var e=null}}return fa[a]={nextPos:ba,result:c},c}function N(){var b="OCTET@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if(null!==a.substr(ba).match(/^[\0-\xFF]/)){var d=a.charAt(ba);ba++}else{var d=null;ca&&f("[\\0-\\xFF]")}return fa[b]={nextPos:ba,result:d},d}function O(){var b="SP@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if(" "===a.substr(ba,1)){var d=" ";ba+=1}else{var d=null;ca&&f('" "')}return fa[b]={nextPos:ba,result:d},d}function P(){var b="VCHAR@"+ba,c=fa[b];if(c)return ba=c.nextPos,c.result;if(null!==a.substr(ba).match(/^[!-~]/)){var d=a.charAt(ba);ba++}else{var d=null;ca&&f("[!-~]")}return fa[b]={nextPos:ba,result:d},d}function Q(){var a="WSP@"+ba,b=fa[a];if(b)return ba=b.nextPos,b.result;var c=O();if(null!==c)var d=c;else{var e=K();if(null!==e)var d=e;else var d=null}return fa[a]={nextPos:ba,result:d},d}function R(){function b(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(ea),d=Math.max(ba,da),f=d<a.length?e(a.charAt(d)):"end of input";return"Expected "+c+" but "+f+" found."}function S(){for(var b=1,c=1,d=!1,e=0;da>e;e++){var f=a.charAt(e);"\n"===f?(d||b++,c=1,d=!1):"\r"===f|"\u2028"===f||"\u2029"===f?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}function T(a){for(var b=[],c=0;c<a.length;c++)"object"==typeof a[c]?b=b.concat(T(a[c])):b.push(a[c]);return b}function U(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function V(a){return{type:"text",val:a}}function W(){return{type:"tag",name:"newpage"}}function X(a){return{type:"tag",name:"chapter",title:a}}function Y(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function Z(a){return{type:"tag",name:"jump",pageNumber:a}}function $(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}function _(a,b){return{type:"tag",name:"ruby",rubyBase:a,rubyText:b}}var aa={ALPHA:B,BIT:C,CHAR:D,CR:E,CRLF:F,CTL:G,DIGIT:H,DQUOTE:I,HEXDIG:J,HTAB:K,LF:L,LWSP:M,OCTET:N,SP:O,URI:y,VCHAR:P,WSP:Q,chapterTitle:u,inlineInlineText:l,inlineInlineToken:m,inlineInlineTokens:n,inlineText:i,inlineToken:j,inlineTokens:k,integer:x,jumpuriTitle:v,novel:g,numeric:w,tag:o,tagChapter:q,tagJump:s,tagJumpuri:t,tagNewpage:p,tagPixivimage:r,tagRuby:A,text:h,uri_chrs:z};if(void 0!==b){if(void 0===aa[b])throw Error("Invalid rule name: "+e(b)+".")}else b="novel";var ba=0,ca=!0,da=0,ea=[],fa={},ga=aa[b]();if(null===ga||ba!==a.length){var ha=S();throw new this.SyntaxError(R(),ha.line,ha.column)}return ga},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}();b?module.exports=c:(a.PixivNovelParser=a.PixivNovelParser||{},a.PixivNovelParser.basicParser=c)}((this||0).self||global),function(a){var b="process"in a,c=function(){var a={parse:function(a,b){function c(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function d(a){var b=a.charCodeAt(0);if(255>=b)var d="x",e=2;else var d="u",e=4;return"\\"+d+c(b.toString(16).toUpperCase(),"0",e)}function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,d)+'"'}function f(a){ia>ga||(ga>ia&&(ia=ga,ja=[]),ja.push(a))}function g(){var a="novel@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=[],d=o();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}for(;null!==e;){c.push(e);var d=o();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}}return ka[a]={nextPos:ga,result:c},c}function h(){var b="text@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga;if(null!==a.substr(ga).match(/^[^[]/)){var e=a.charAt(ga);ga++}else{var e=null;ha&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ga).match(/^[^[]/)){var e=a.charAt(ga);ga++}else{var e=null;ha&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var i=ga,j=ga,k=ha;ha=!1;var l=ga,m=ha;ha=!1;var n=o();if(ha=m,null===n)var p="";else{var p=null;ga=l}if(ha=k,null!==p){var q="";ga=j}else var q=null;if(null!==q){if("["===a.substr(ga,1)){var r="[";ga+=1}else{var r=null;ha&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;ga=i}}else{var s=null;ga=i}if(null!==s)var h=s;else var h=null}if(null!==h)for(var t=[];null!==h;){if(t.push(h),null!==a.substr(ga).match(/^[^[]/)){var e=a.charAt(ga);ga++}else{var e=null;ha&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ga).match(/^[^[]/)){var e=a.charAt(ga);ga++}else{var e=null;ha&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var i=ga,j=ga,k=ha;ha=!1;var l=ga,m=ha;ha=!1;var n=o();if(ha=m,null===n)var p="";else{var p=null;ga=l}if(ha=k,null!==p){var q="";ga=j}else var q=null;if(null!==q){if("["===a.substr(ga,1)){var r="[";ga+=1}else{var r=null;ha&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;ga=i}}else{var s=null;ga=i}if(null!==s)var h=s;else var h=null}}else var t=null;var u=null!==t?function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].join("");return Y(b)}(t):null;if(null!==u)var v=u;else{var v=null;ga=d}return ka[b]={nextPos:ga,result:v},v}function i(){var b="inlineText@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga;if(null!==a.substr(ga).match(/^[^[\]]/)){var e=a.charAt(ga);ga++}else{var e=null;ha&&f("[^[\\]]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ga).match(/^[^[\]]/)){var e=a.charAt(ga);ga++}else{var e=null;ha&&f("[^[\\]]")}else var g=null;if(null!==g)var h=g;else{var i=ga,j=ga,k=ha;ha=!1;var l=ga,m=ha;ha=!1;var n=A();if(ha=m,null===n)var o="";else{var o=null;ga=l}if(ha=k,null!==o){var p="";ga=j}else var p=null;if(null!==p){if("["===a.substr(ga,1)){var q="[";ga+=1}else{var q=null;ha&&f('"["')}if(null!==q)var r=[p,q];else{var r=null;ga=i}}else{var r=null;ga=i}if(null!==r)var h=r;else var h=null}if(null!==h)for(var s=[];null!==h;){if(s.push(h),null!==a.substr(ga).match(/^[^[\]]/)){var e=a.charAt(ga);ga++}else{var e=null;ha&&f("[^[\\]]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ga).match(/^[^[\]]/)){var e=a.charAt(ga);ga++}else{var e=null;ha&&f("[^[\\]]")}else var g=null;if(null!==g)var h=g;else{var i=ga,j=ga,k=ha;ha=!1;var l=ga,m=ha;ha=!1;var n=A();if(ha=m,null===n)var o="";else{var o=null;ga=l}if(ha=k,null!==o){var p="";ga=j}else var p=null;if(null!==p){if("["===a.substr(ga,1)){var q="[";ga+=1}else{var q=null;ha&&f('"["')}if(null!==q)var r=[p,q];else{var r=null;ga=i}}else{var r=null;ga=i}if(null!==r)var h=r;else var h=null}}else var s=null;var t=null!==s?function(a){return Y(X(W(a).join("")))}(s):null;if(null!==t)var u=t;else{var u=null;ga=d}return ka[b]={nextPos:ga,result:u},u}function j(){var a="inlineToken@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=A();if(null!==c)var d=c;else{var e=i();if(null!==e)var d=e;else var d=null}return ka[a]={nextPos:ga,result:d},d}function k(){var a="inlineTokens@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=j();if(null!==c)for(var d=[];null!==c;){d.push(c);var c=j()}else var d=null;return ka[a]={nextPos:ga,result:d},d}function l(){var b="inlineInlineText@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if(null!==a.substr(ga).match(/^[^[>]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[^[>]")}if(null!==g)for(var h=[];null!==g;)if(h.push(g),null!==a.substr(ga).match(/^[^[>]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[^[>]")}else var h=null;if(null!==h){var i=ga,j=ha;ha=!1;var k=ga,l=ha;if(ha=!1,"]]"===a.substr(ga,2)){var m="]]";ga+=2}else{var m=null;ha&&f('"]]"')}if(ha=l,null===m)var n="";else{var n=null;ga=k}if(ha=j,null!==n){var o="";ga=i}else var o=null;if(null!==o)var p=[h,o];else{var p=null;ga=e}}else{var p=null;ga=e}if(null!==p)var q=p;else{var r=ga,s=ga,t=ha;ha=!1;var u=ga,v=ha;ha=!1;var w=A();if(ha=v,null===w)var x="";else{var x=null;ga=u}if(ha=t,null!==x){var y="";ga=s}else var y=null;if(null!==y){if("["===a.substr(ga,1)){var z="[";ga+=1}else{var z=null;ha&&f('"["')}if(null!==z)var B=[y,z];else{var B=null;ga=r}}else{var B=null;ga=r}if(null!==B)var q=B;else var q=null}if(null!==q)for(var C=[];null!==q;){C.push(q);var e=ga;if(null!==a.substr(ga).match(/^[^[>]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[^[>]")}if(null!==g)for(var h=[];null!==g;)if(h.push(g),null!==a.substr(ga).match(/^[^[>]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[^[>]")}else var h=null;if(null!==h){var i=ga,j=ha;ha=!1;var k=ga,l=ha;if(ha=!1,"]]"===a.substr(ga,2)){var m="]]";ga+=2}else{var m=null;ha&&f('"]]"')}if(ha=l,null===m)var n="";else{var n=null;ga=k}if(ha=j,null!==n){var o="";ga=i}else var o=null;if(null!==o)var p=[h,o];else{var p=null;ga=e}}else{var p=null;ga=e}if(null!==p)var q=p;else{var r=ga,s=ga,t=ha;ha=!1;var u=ga,v=ha;ha=!1;var w=A();if(ha=v,null===w)var x="";else{var x=null;ga=u}if(ha=t,null!==x){var y="";ga=s}else var y=null;if(null!==y){if("["===a.substr(ga,1)){var z="[";ga+=1}else{var z=null;ha&&f('"["')}if(null!==z)var B=[y,z];else{var B=null;ga=r}}else{var B=null;ga=r}if(null!==B)var q=B;else var q=null}}else var C=null;var D=null!==C?function(a){return Y(X(W(a).join("")))}(C):null;if(null!==D)var E=D;else{var E=null;ga=d}return ka[b]={nextPos:ga,result:E},E}function m(){var a="inlineInlineToken@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=A();if(null!==c)var d=c;else{var e=l();if(null!==e)var d=e;else var d=null}return ka[a]={nextPos:ga,result:d},d}function n(){var a="inlineInlineTokens@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=m();if(null!==c)for(var d=[];null!==c;){d.push(c);var c=m()}else var d=null;return ka[a]={nextPos:ga,result:d},d}function o(){var a="tag@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=p();if(null!==c)var d=c;else{var e=q();if(null!==e)var d=e;else{var f=r();if(null!==f)var d=f;else{var g=s();if(null!==g)var d=g;else{var h=t();if(null!==h)var d=h;else{var i=A();if(null!==i)var d=i;else{var j=B();if(null!==j)var d=j;else{var k=C();if(null!==k)var d=k;else var d=null}}}}}}}return ka[a]={nextPos:ga,result:d},d}function p(){var b="tagNewpage@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if("[newpage]"===a.substr(ga,9)){var g="[newpage]";ga+=9}else{var g=null;ha&&f('"[newpage]"')}if(null!==g){var h=H();if(null!==h)var i=h;else{var j=O();if(null!==j)var i=j;else var i=null}var k=null!==i?i:"";if(null!==k)var l=[g,k];else{var l=null;ga=e}}else{var l=null;ga=e}var m=null!==l?function(){return Z()}():null;if(null!==m)var n=m;else{var n=null;ga=d}return ka[b]={nextPos:ga,result:n},n}function q(){var b="tagChapter@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if("[chapter:"===a.substr(ga,9)){var g="[chapter:";ga+=9}else{var g=null;ha&&f('"[chapter:"')}if(null!==g){var h=k();if(null!==h){if("]"===a.substr(ga,1)){var i="]";ga+=1}else{var i=null;ha&&f('"]"')}if(null!==i){var j=H();if(null!==j)var l=j;else{var m=O();if(null!==m)var l=m;else var l=null}var n=null!==l?l:"";if(null!==n)var o=[g,h,i,n];else{var o=null;ga=e}}else{var o=null;ga=e}}else{var o=null;ga=e}}else{var o=null;ga=e}var p=null!==o?function(a){return $(a)}(o[1]):null;if(null!==p)var q=p;else{var q=null;ga=d}return ka[b]={nextPos:ga,result:q},q}function r(){var b="tagPixivimage@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if("[pixivimage:"===a.substr(ga,12)){var g="[pixivimage:";ga+=12}else{var g=null;ha&&f('"[pixivimage:"')}if(null!==g){var h=w();if(null!==h){var i=ga;if("-"===a.substr(ga,1)){var j="-";ga+=1}else{var j=null;ha&&f('"-"')}if(null!==j){var k=x();if(null!==k)var l=[j,k];else{var l=null;ga=i}}else{var l=null;ga=i}var m=null!==l?l:"";if(null!==m){if("]"===a.substr(ga,1)){var n="]";ga+=1}else{var n=null;ha&&f('"]"')}if(null!==n)var o=[g,h,m,n];else{var o=null;ga=e}}else{var o=null;ga=e}}else{var o=null;ga=e}}else{var o=null;ga=e}var p=null!==o?function(a,b){return _(a,b&&b[1])}(o[1],o[2]):null;if(null!==p)var q=p;else{var q=null;ga=d}return ka[b]={nextPos:ga,result:q},q}function s(){var b="tagJump@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if("[jump:"===a.substr(ga,6)){var g="[jump:";ga+=6}else{var g=null;ha&&f('"[jump:"')}if(null!==g){var h=x();if(null!==h){if("]"===a.substr(ga,1)){var i="]";ga+=1}else{var i=null;ha&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;ga=e}}else{var j=null;ga=e}}else{var j=null;ga=e}var k=null!==j?function(a){return aa(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;ga=d}return ka[b]={nextPos:ga,result:l},l}function t(){var b="tagJumpuri@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if("[[jumpuri:"===a.substr(ga,10)){var g="[[jumpuri:";ga+=10}else{var g=null;ha&&f('"[[jumpuri:"')}if(null!==g){var h=n();if(null!==h){if(">"===a.substr(ga,1)){var i=">";ga+=1}else{var i=null;ha&&f('">"')}if(null!==i){for(var j=[],k=T();null!==k;){j.push(k);var k=T()}if(null!==j){var l=y();if(null!==l){for(var m=[],o=T();null!==o;){m.push(o);var o=T()}if(null!==m){if("]]"===a.substr(ga,2)){var p="]]";ga+=2}else{var p=null;
ha&&f('"]]"')}if(null!==p)var q=[g,h,i,j,l,m,p];else{var q=null;ga=e}}else{var q=null;ga=e}}else{var q=null;ga=e}}else{var q=null;ga=e}}else{var q=null;ga=e}}else{var q=null;ga=e}}else{var q=null;ga=e}var r=null!==q?function(a,b){return ba(a,b)}(q[1],q[4]):null;if(null!==r)var s=r;else{var s=null;ga=d}return ka[b]={nextPos:ga,result:s},s}function u(){var b="chapterTitle@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=[];if(null!==a.substr(ga).match(/^[^\]]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[^\\]]")}for(;null!==g;)if(e.push(g),null!==a.substr(ga).match(/^[^\]]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[^\\]]")}var h=null!==e?function(a){return X(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;ga=d}return ka[b]={nextPos:ga,result:i},i}function v(){var b="jumpuriTitle@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=[];if(null!==a.substr(ga).match(/^[^>]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[^>]")}for(;null!==g;)if(e.push(g),null!==a.substr(ga).match(/^[^>]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[^>]")}var h=null!==e?function(a){return X(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;ga=d}return ka[b]={nextPos:ga,result:i},i}function w(){var a="numeric@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=ga,d=K();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=K()}else var e=null;var f=null!==e?function(a){return a.join("")}(e):null;if(null!==f)var g=f;else{var g=null;ga=c}return ka[a]={nextPos:ga,result:g},g}function x(){var a="integer@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=ga,d=K();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=K()}else var e=null;var f=null!==e?function(a){return parseInt(a.join(""),10)}(e):null;if(null!==f)var g=f;else{var g=null;ga=c}return ka[a]={nextPos:ga,result:g},g}function y(){var b="URI@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga,g=ga;if("http"===a.substr(ga,4)){var h="http";ga+=4}else{var h=null;ha&&f('"http"')}if(null!==h){if("s"===a.substr(ga,1)){var i="s";ga+=1}else{var i=null;ha&&f('"s"')}var j=null!==i?i:"";if(null!==j){if("://"===a.substr(ga,3)){var k="://";ga+=3}else{var k=null;ha&&f('"://"')}if(null!==k)var l=[h,j,k];else{var l=null;ga=g}}else{var l=null;ga=g}}else{var l=null;ga=g}if(null!==l){for(var m=[],n=z();null!==n;){m.push(n);var n=z()}if(null!==m)var o=[l,m];else{var o=null;ga=e}}else{var o=null;ga=e}var p=null!==o?function(a,b){return a.join("")+b.join("")}(o[0],o[1]):null;if(null!==p)var q=p;else{var q=null;ga=d}return ka[b]={nextPos:ga,result:q},q}function z(){var b="uri_chrs@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=E();if(null!==d)var e=d;else{var g=K();if(null!==g)var e=g;else{var h=ga;if("%"===a.substr(ga,1)){var i="%";ga+=1}else{var i=null;ha&&f('"%"')}if(null!==i){var j=M();if(null!==j)for(var k=[];null!==j;){k.push(j);var j=M()}else var k=null;if(null!==k)var l=[i,k];else{var l=null;ga=h}}else{var l=null;ga=h}if(null!==l)var e=l;else{if(null!==a.substr(ga).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var m=a.charAt(ga);ga++}else{var m=null;ha&&f("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==m)var e=m;else var e=null}}}return ka[b]={nextPos:ga,result:e},e}function A(){var b="tagRuby@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if("[[ruby:"===a.substr(ga,7)){var g="[[ruby:";ga+=7}else{var g=null;ha&&f('"[[ruby:"')}if(null!==g){var h=[];if(null!==a.substr(ga).match(/^[^>]/)){var i=a.charAt(ga);ga++}else{var i=null;ha&&f("[^>]")}for(;null!==i;)if(h.push(i),null!==a.substr(ga).match(/^[^>]/)){var i=a.charAt(ga);ga++}else{var i=null;ha&&f("[^>]")}if(null!==h){if(">"===a.substr(ga,1)){var j=">";ga+=1}else{var j=null;ha&&f('">"')}if(null!==j){var k=[];if(null!==a.substr(ga).match(/^[^\]]/)){var l=a.charAt(ga);ga++}else{var l=null;ha&&f("[^\\]]")}if(null!==l)for(var m=[];null!==l;)if(m.push(l),null!==a.substr(ga).match(/^[^\]]/)){var l=a.charAt(ga);ga++}else{var l=null;ha&&f("[^\\]]")}else var m=null;if(null!==m)var n=m;else{var o=ga;if("]"===a.substr(ga,1)){var p="]";ga+=1}else{var p=null;ha&&f('"]"')}if(null!==p){var q=ga,r=ha;ha=!1;var s=ga,t=ha;if(ha=!1,"]"===a.substr(ga,1)){var u="]";ga+=1}else{var u=null;ha&&f('"]"')}if(ha=t,null===u)var v="";else{var v=null;ga=s}if(ha=r,null!==v){var w="";ga=q}else var w=null;if(null!==w)var x=[p,w];else{var x=null;ga=o}}else{var x=null;ga=o}if(null!==x)var n=x;else var n=null}for(;null!==n;){if(k.push(n),null!==a.substr(ga).match(/^[^\]]/)){var l=a.charAt(ga);ga++}else{var l=null;ha&&f("[^\\]]")}if(null!==l)for(var m=[];null!==l;)if(m.push(l),null!==a.substr(ga).match(/^[^\]]/)){var l=a.charAt(ga);ga++}else{var l=null;ha&&f("[^\\]]")}else var m=null;if(null!==m)var n=m;else{var o=ga;if("]"===a.substr(ga,1)){var p="]";ga+=1}else{var p=null;ha&&f('"]"')}if(null!==p){var q=ga,r=ha;ha=!1;var s=ga,t=ha;if(ha=!1,"]"===a.substr(ga,1)){var u="]";ga+=1}else{var u=null;ha&&f('"]"')}if(ha=t,null===u)var v="";else{var v=null;ga=s}if(ha=r,null!==v){var w="";ga=q}else var w=null;if(null!==w)var x=[p,w];else{var x=null;ga=o}}else{var x=null;ga=o}if(null!==x)var n=x;else var n=null}}if(null!==k){if("]]"===a.substr(ga,2)){var y="]]";ga+=2}else{var y=null;ha&&f('"]]"')}if(null!==y)var z=[g,h,j,k,y];else{var z=null;ga=e}}else{var z=null;ga=e}}else{var z=null;ga=e}}else{var z=null;ga=e}}else{var z=null;ga=e}var A=null!==z?function(a,b){return ca(X(a.join("")),X(W(b).join("")))}(z[1],z[3]):null;if(null!==A)var B=A;else{var B=null;ga=d}return ka[b]={nextPos:ga,result:B},B}function B(){var b="tagEmoji@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if("[emoji:"===a.substr(ga,7)){var g="[emoji:";ga+=7}else{var g=null;ha&&f('"[emoji:"')}if(null!==g){var h=D();if(null!==h){if("]"===a.substr(ga,1)){var i="]";ga+=1}else{var i=null;ha&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;ga=e}}else{var j=null;ga=e}}else{var j=null;ga=e}var k=null!==j?function(a){return da(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;ga=d}return ka[b]={nextPos:ga,result:l},l}function C(){var b="tagStrong@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=ga;if("[strong:"===a.substr(ga,8)){var g="[strong:";ga+=8}else{var g=null;ha&&f('"[strong:"')}if(null!==g){var h=[];if(null!==a.substr(ga).match(/^[^\]]/)){var i=a.charAt(ga);ga++}else{var i=null;ha&&f("[^\\]]")}for(;null!==i;)if(h.push(i),null!==a.substr(ga).match(/^[^\]]/)){var i=a.charAt(ga);ga++}else{var i=null;ha&&f("[^\\]]")}if(null!==h){if("]"===a.substr(ga,1)){var j="]";ga+=1}else{var j=null;ha&&f('"]"')}if(null!==j)var k=[g,h,j];else{var k=null;ga=e}}else{var k=null;ga=e}}else{var k=null;ga=e}var l=null!==k?function(a){return ea(X(a.join("")))}(k[1]):null;if(null!==l)var m=l;else{var m=null;ga=d}return ka[b]={nextPos:ga,result:m},m}function D(){var b="emojiName@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=ga,e=E();if(null!==e)var g=e;else{var h=K();if(null!==h)var g=h;else{if("-"===a.substr(ga,1)){var i="-";ga+=1}else{var i=null;ha&&f('"-"')}if(null!==i)var g=i;else var g=null}}if(null!==g)for(var j=[];null!==g;){j.push(g);var e=E();if(null!==e)var g=e;else{var h=K();if(null!==h)var g=h;else{if("-"===a.substr(ga,1)){var i="-";ga+=1}else{var i=null;ha&&f('"-"')}if(null!==i)var g=i;else var g=null}}}else var j=null;var k=null!==j?function(a){return X(a.join(""))}(j):null;if(null!==k)var l=k;else{var l=null;ga=d}return ka[b]={nextPos:ga,result:l},l}function E(){var b="ALPHA@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if(null!==a.substr(ga).match(/^[A-Z]/)){var d=a.charAt(ga);ga++}else{var d=null;ha&&f("[A-Z]")}if(null!==d)var e=d;else{if(null!==a.substr(ga).match(/^[a-z]/)){var g=a.charAt(ga);ga++}else{var g=null;ha&&f("[a-z]")}if(null!==g)var e=g;else var e=null}return ka[b]={nextPos:ga,result:e},e}function F(){var b="BIT@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if("0"===a.substr(ga,1)){var d="0";ga+=1}else{var d=null;ha&&f('"0"')}if(null!==d)var e=d;else{if("1"===a.substr(ga,1)){var g="1";ga+=1}else{var g=null;ha&&f('"1"')}if(null!==g)var e=g;else var e=null}return ka[b]={nextPos:ga,result:e},e}function G(){var b="CHAR@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if(null!==a.substr(ga).match(/^[-]/)){var d=a.charAt(ga);ga++}else{var d=null;ha&&f("[-]")}return ka[b]={nextPos:ga,result:d},d}function H(){var b="CR@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if("\r"===a.substr(ga,1)){var d="\r";ga+=1}else{var d=null;ha&&f('"\\r"')}return ka[b]={nextPos:ga,result:d},d}function I(){var a="CRLF@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=ga,d=H();if(null!==d){var e=O();if(null!==e)var f=[d,e];else{var f=null;ga=c}}else{var f=null;ga=c}return ka[a]={nextPos:ga,result:f},f}function J(){var b="CTL@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if(null!==a.substr(ga).match(/^[\0-]/)){var d=a.charAt(ga);ga++}else{var d=null;ha&&f("[\\0-]")}if(null!==d)var e=d;else{if(""===a.substr(ga,1)){var g="";ga+=1}else{var g=null;ha&&f('""')}if(null!==g)var e=g;else var e=null}return ka[b]={nextPos:ga,result:e},e}function K(){var b="DIGIT@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if(null!==a.substr(ga).match(/^[0-9]/)){var d=a.charAt(ga);ga++}else{var d=null;ha&&f("[0-9]")}return ka[b]={nextPos:ga,result:d},d}function L(){var b="DQUOTE@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if(null!==a.substr(ga).match(/^["]/)){var d=a.charAt(ga);ga++}else{var d=null;ha&&f('["]')}return ka[b]={nextPos:ga,result:d},d}function M(){var b="HEXDIG@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;var d=K();if(null!==d)var e=d;else{if("A"===a.substr(ga,1)){var g="A";ga+=1}else{var g=null;ha&&f('"A"')}if(null!==g)var e=g;else{if("B"===a.substr(ga,1)){var h="B";ga+=1}else{var h=null;ha&&f('"B"')}if(null!==h)var e=h;else{if("C"===a.substr(ga,1)){var i="C";ga+=1}else{var i=null;ha&&f('"C"')}if(null!==i)var e=i;else{if("D"===a.substr(ga,1)){var j="D";ga+=1}else{var j=null;ha&&f('"D"')}if(null!==j)var e=j;else{if("E"===a.substr(ga,1)){var k="E";ga+=1}else{var k=null;ha&&f('"E"')}if(null!==k)var e=k;else{if("F"===a.substr(ga,1)){var l="F";ga+=1}else{var l=null;ha&&f('"F"')}if(null!==l)var e=l;else var e=null}}}}}}return ka[b]={nextPos:ga,result:e},e}function N(){var b="HTAB@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if("	"===a.substr(ga,1)){var d="	";ga+=1}else{var d=null;ha&&f('"	"')}return ka[b]={nextPos:ga,result:d},d}function O(){var b="LF@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if("\n"===a.substr(ga,1)){var d="\n";ga+=1}else{var d=null;ha&&f('"\\n"')}return ka[b]={nextPos:ga,result:d},d}function P(){var a="LWSP@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=[],d=T();if(null!==d)var e=d;else{var f=ga,g=I();if(null!==g){var h=T();if(null!==h)var i=[g,h];else{var i=null;ga=f}}else{var i=null;ga=f}if(null!==i)var e=i;else var e=null}for(;null!==e;){c.push(e);var d=T();if(null!==d)var e=d;else{var f=ga,g=I();if(null!==g){var h=T();if(null!==h)var i=[g,h];else{var i=null;ga=f}}else{var i=null;ga=f}if(null!==i)var e=i;else var e=null}}return ka[a]={nextPos:ga,result:c},c}function Q(){var b="OCTET@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if(null!==a.substr(ga).match(/^[\0-\xFF]/)){var d=a.charAt(ga);ga++}else{var d=null;ha&&f("[\\0-\\xFF]")}return ka[b]={nextPos:ga,result:d},d}function R(){var b="SP@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if(" "===a.substr(ga,1)){var d=" ";ga+=1}else{var d=null;ha&&f('" "')}return ka[b]={nextPos:ga,result:d},d}function S(){var b="VCHAR@"+ga,c=ka[b];if(c)return ga=c.nextPos,c.result;if(null!==a.substr(ga).match(/^[!-~]/)){var d=a.charAt(ga);ga++}else{var d=null;ha&&f("[!-~]")}return ka[b]={nextPos:ga,result:d},d}function T(){var a="WSP@"+ga,b=ka[a];if(b)return ga=b.nextPos,b.result;var c=R();if(null!==c)var d=c;else{var e=N();if(null!==e)var d=e;else var d=null}return ka[a]={nextPos:ga,result:d},d}function U(){function b(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(ja),d=Math.max(ga,ia),f=d<a.length?e(a.charAt(d)):"end of input";return"Expected "+c+" but "+f+" found."}function V(){for(var b=1,c=1,d=!1,e=0;ia>e;e++){var f=a.charAt(e);"\n"===f?(d||b++,c=1,d=!1):"\r"===f|"\u2028"===f||"\u2029"===f?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}function W(a){for(var b=[],c=0;c<a.length;c++)"object"==typeof a[c]?b=b.concat(W(a[c])):b.push(a[c]);return b}function X(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function Y(a){return{type:"text",val:a}}function Z(){return{type:"tag",name:"newpage"}}function $(a){return{type:"tag",name:"chapter",title:a}}function _(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function aa(a){return{type:"tag",name:"jump",pageNumber:a}}function ba(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}function ca(a,b){return{type:"tag",name:"ruby",rubyBase:a,rubyText:b}}function da(a){return{type:"tag",name:"emoji",emojiName:a}}function ea(a){return{type:"tag",name:"strong",val:a}}var fa={ALPHA:E,BIT:F,CHAR:G,CR:H,CRLF:I,CTL:J,DIGIT:K,DQUOTE:L,HEXDIG:M,HTAB:N,LF:O,LWSP:P,OCTET:Q,SP:R,URI:y,VCHAR:S,WSP:T,chapterTitle:u,emojiName:D,inlineInlineText:l,inlineInlineToken:m,inlineInlineTokens:n,inlineText:i,inlineToken:j,inlineTokens:k,integer:x,jumpuriTitle:v,novel:g,numeric:w,tag:o,tagChapter:q,tagEmoji:B,tagJump:s,tagJumpuri:t,tagNewpage:p,tagPixivimage:r,tagRuby:A,tagStrong:C,text:h,uri_chrs:z};if(void 0!==b){if(void 0===fa[b])throw Error("Invalid rule name: "+e(b)+".")}else b="novel";var ga=0,ha=!0,ia=0,ja=[],ka={},la=fa[b]();if(null===la||ga!==a.length){var ma=V();throw new this.SyntaxError(U(),ma.line,ma.column)}return la},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}();b?module.exports=c:(a.PixivNovelParser=a.PixivNovelParser||{},a.PixivNovelParser.extendedParser=c)}((this||0).self||global),function(a){"use strict";function b(a){a=a||{},this.syntax=a.syntax||"basic",this.tree=[]}var c,d,e="process"in a;e?(c=require("./parser.peg.js"),d=require("./parser-extended.peg.js")):(c=PixivNovelParser.basicParser,d=PixivNovelParser.extendedParser),b.parse=function(a,b){b=b||{},b.syntax=b.syntax||"basic";try{switch(a=a.replace(/\r?\n/g,"\n").replace(/[\s\u200c]/g,function(a){return"\n"===a||"　"===a?a:" "}),b.syntax){case"extended":return d.parse(a);case"basic":default:return c.parse(a)}}catch(e){return console.error(e),[{type:"text",val:a}]}},b.prototype.parse=function(a){return this.tree=b.parse(a,{syntax:this.syntax}),this},b.prototype.toJSON=function(){return JSON.stringify(this.tree)},e?module.exports={Parser:b}:(a.PixivNovelParser=a.PixivNovalPerser||{},a.PixivNovelParser.Parser=b)}((this||0).self||global),function(a){"use strict";var b="process"in a;b?module.exports=require("./parser"):a.PixivNovelParser=a.PixivNovelParser||{}}((this||0).self||global);
//# sourceMappingURL=pixiv-novel-parser.min.js.map