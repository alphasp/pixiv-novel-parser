!function(l){var r="process"in l,e=function(){var l={parse:function(l,r){function e(l,r,e){for(var n=l,u=e-l.length,a=0;u>a;a++)n=r+n;return n}function n(l){var r=l.charCodeAt(0);if(255>=r)var n="x",u=2;else var n="u",u=4;return"\\"+n+e(r.toString(16).toUpperCase(),"0",u)}function u(l){return'"'+l.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,n)+'"'}function a(l){al>nl||(nl>al&&(al=nl,sl=[]),sl.push(l))}function s(){var l="novel@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=[],n=x();if(null!==n)var u=n;else{var a=v();if(null!==a)var u=a;else var u=null}for(;null!==u;){e.push(u);var n=x();if(null!==n)var u=n;else{var a=v();if(null!==a)var u=a;else var u=null}}return vl[l]={nextPos:nl,result:e},e}function v(){var r="text@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl;if(null!==l.substr(nl).match(/^[^[\r\n]/)){var u=l.charAt(nl);nl++}else{var u=null;ul&&a("[^[\\r\\n]")}if(null!==u)for(var s=[];null!==u;)if(s.push(u),null!==l.substr(nl).match(/^[^[\r\n]/)){var u=l.charAt(nl);nl++}else{var u=null;ul&&a("[^[\\r\\n]")}else var s=null;if(null!==s)var v=s;else{var t=nl,i=nl,f=ul;ul=!1;var o=nl,c=ul;ul=!1;var h=x();if(ul=c,null===h)var b="";else{var b=null;nl=o}if(ul=f,null!==b){var m="";nl=i}else var m=null;if(null!==m){if("["===l.substr(nl,1)){var g="[";nl+=1}else{var g=null;ul&&a('"["')}if(null!==g)var A=[m,g];else{var A=null;nl=t}}else{var A=null;nl=t}if(null!==A)var v=A;else{var T=nl,j=nl,y=ul;ul=!1;var F=nl,C=ul;ul=!1;var E=P();if(null!==E)var I=E;else{var S=p();if(null!==S)var I=S;else var I=null}if(ul=C,null===I)var N="";else{var N=null;nl=F}if(ul=y,null!==N){var w="";nl=j}else var w=null;if(null!==w){var L=d();if(null!==L)var R=[w,L];else{var R=null;nl=T}}else{var R=null;nl=T}if(null!==R)var v=R;else var v=null}}if(null!==v)for(var k=[];null!==v;){if(k.push(v),null!==l.substr(nl).match(/^[^[\r\n]/)){var u=l.charAt(nl);nl++}else{var u=null;ul&&a("[^[\\r\\n]")}if(null!==u)for(var s=[];null!==u;)if(s.push(u),null!==l.substr(nl).match(/^[^[\r\n]/)){var u=l.charAt(nl);nl++}else{var u=null;ul&&a("[^[\\r\\n]")}else var s=null;if(null!==s)var v=s;else{var t=nl,i=nl,f=ul;ul=!1;var o=nl,c=ul;ul=!1;var h=x();if(ul=c,null===h)var b="";else{var b=null;nl=o}if(ul=f,null!==b){var m="";nl=i}else var m=null;if(null!==m){if("["===l.substr(nl,1)){var g="[";nl+=1}else{var g=null;ul&&a('"["')}if(null!==g)var A=[m,g];else{var A=null;nl=t}}else{var A=null;nl=t}if(null!==A)var v=A;else{var T=nl,j=nl,y=ul;ul=!1;var F=nl,C=ul;ul=!1;var E=P();if(null!==E)var I=E;else{var S=p();if(null!==S)var I=S;else var I=null}if(ul=C,null===I)var N="";else{var N=null;nl=F}if(ul=y,null!==N){var w="";nl=j}else var w=null;if(null!==w){var L=d();if(null!==L)var R=[w,L];else{var R=null;nl=T}}else{var R=null;nl=T}if(null!==R)var v=R;else var v=null}}}else var k=null;var D=null!==k?function(l){for(var r="",e=0;e<l.length;e++)r+=l[e].join("");return Z(r)}(k):null;if(null!==D)var H=D;else{var H=null;nl=n}return vl[r]={nextPos:nl,result:H},H}function t(){var r="inlineText@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl;if(null!==l.substr(nl).match(/^[^[\]]/)){var u=l.charAt(nl);nl++}else{var u=null;ul&&a("[^[\\]]")}if(null!==u)for(var s=[];null!==u;)if(s.push(u),null!==l.substr(nl).match(/^[^[\]]/)){var u=l.charAt(nl);nl++}else{var u=null;ul&&a("[^[\\]]")}else var s=null;if(null!==s)var v=s;else{var t=nl,i=nl,f=ul;ul=!1;var o=nl,c=ul;ul=!1;var h=I();if(ul=c,null===h)var x="";else{var x=null;nl=o}if(ul=f,null!==x){var P="";nl=i}else var P=null;if(null!==P){if("["===l.substr(nl,1)){var p="[";nl+=1}else{var p=null;ul&&a('"["')}if(null!==p)var b=[P,p];else{var b=null;nl=t}}else{var b=null;nl=t}if(null!==b)var v=b;else var v=null}if(null!==v)for(var m=[];null!==v;){if(m.push(v),null!==l.substr(nl).match(/^[^[\]]/)){var u=l.charAt(nl);nl++}else{var u=null;ul&&a("[^[\\]]")}if(null!==u)for(var s=[];null!==u;)if(s.push(u),null!==l.substr(nl).match(/^[^[\]]/)){var u=l.charAt(nl);nl++}else{var u=null;ul&&a("[^[\\]]")}else var s=null;if(null!==s)var v=s;else{var t=nl,i=nl,f=ul;ul=!1;var o=nl,c=ul;ul=!1;var h=I();if(ul=c,null===h)var x="";else{var x=null;nl=o}if(ul=f,null!==x){var P="";nl=i}else var P=null;if(null!==P){if("["===l.substr(nl,1)){var p="[";nl+=1}else{var p=null;ul&&a('"["')}if(null!==p)var b=[P,p];else{var b=null;nl=t}}else{var b=null;nl=t}if(null!==b)var v=b;else var v=null}}else var m=null;var g=null!==m?function(l){return Z(X(V(l).join("")))}(m):null;if(null!==g)var A=g;else{var A=null;nl=n}return vl[r]={nextPos:nl,result:A},A}function i(){var l="inlineToken@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=I();if(null!==e)var n=e;else{var u=t();if(null!==u)var n=u;else var n=null}return vl[l]={nextPos:nl,result:n},n}function f(){var l="inlineTokens@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=i();if(null!==e)for(var n=[];null!==e;){n.push(e);var e=i()}else var n=null;return vl[l]={nextPos:nl,result:n},n}function o(){var r="inlineInlineText@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl;if(null!==l.substr(nl).match(/^[^[>]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[^[>]")}if(null!==s)for(var v=[];null!==s;)if(v.push(s),null!==l.substr(nl).match(/^[^[>]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[^[>]")}else var v=null;if(null!==v){var t=nl,i=ul;ul=!1;var f=nl,o=ul;if(ul=!1,"]]"===l.substr(nl,2)){var c="]]";nl+=2}else{var c=null;ul&&a('"]]"')}if(ul=o,null===c)var h="";else{var h=null;nl=f}if(ul=i,null!==h){var x="";nl=t}else var x=null;if(null!==x)var P=[v,x];else{var P=null;nl=u}}else{var P=null;nl=u}if(null!==P)var p=P;else{var b=nl,m=nl,g=ul;ul=!1;var A=nl,T=ul;ul=!1;var j=I();if(ul=T,null===j)var y="";else{var y=null;nl=A}if(ul=g,null!==y){var F="";nl=m}else var F=null;if(null!==F){if("["===l.substr(nl,1)){var C="[";nl+=1}else{var C=null;ul&&a('"["')}if(null!==C)var E=[F,C];else{var E=null;nl=b}}else{var E=null;nl=b}if(null!==E)var p=E;else var p=null}if(null!==p)for(var d=[];null!==p;){d.push(p);var u=nl;if(null!==l.substr(nl).match(/^[^[>]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[^[>]")}if(null!==s)for(var v=[];null!==s;)if(v.push(s),null!==l.substr(nl).match(/^[^[>]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[^[>]")}else var v=null;if(null!==v){var t=nl,i=ul;ul=!1;var f=nl,o=ul;if(ul=!1,"]]"===l.substr(nl,2)){var c="]]";nl+=2}else{var c=null;ul&&a('"]]"')}if(ul=o,null===c)var h="";else{var h=null;nl=f}if(ul=i,null!==h){var x="";nl=t}else var x=null;if(null!==x)var P=[v,x];else{var P=null;nl=u}}else{var P=null;nl=u}if(null!==P)var p=P;else{var b=nl,m=nl,g=ul;ul=!1;var A=nl,T=ul;ul=!1;var j=I();if(ul=T,null===j)var y="";else{var y=null;nl=A}if(ul=g,null!==y){var F="";nl=m}else var F=null;if(null!==F){if("["===l.substr(nl,1)){var C="[";nl+=1}else{var C=null;ul&&a('"["')}if(null!==C)var E=[F,C];else{var E=null;nl=b}}else{var E=null;nl=b}if(null!==E)var p=E;else var p=null}}else var d=null;var S=null!==d?function(l){return Z(X(V(l).join("")))}(d):null;if(null!==S)var N=S;else{var N=null;nl=n}return vl[r]={nextPos:nl,result:N},N}function c(){var l="inlineInlineToken@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=I();if(null!==e)var n=e;else{var u=o();if(null!==u)var n=u;else var n=null}return vl[l]={nextPos:nl,result:n},n}function h(){var l="inlineInlineTokens@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=c();if(null!==e)for(var n=[];null!==e;){n.push(e);var e=c()}else var n=null;return vl[l]={nextPos:nl,result:n},n}function x(){var l="tag@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=P();if(null!==e)var n=e;else{var u=p();if(null!==u)var n=u;else{var a=b();if(null!==a)var n=a;else{var s=m();if(null!==s)var n=s;else{var v=g();if(null!==v)var n=v;else{var t=I();if(null!==t)var n=t;else var n=null}}}}}return vl[l]={nextPos:nl,result:n},n}function P(){var r="tagNewpage@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl,s=d(),v=null!==s?s:"";if(null!==v){if("[newpage]"===l.substr(nl,9)){var t="[newpage]";nl+=9}else{var t=null;ul&&a('"[newpage]"')}if(null!==t){var i=d(),f=null!==i?i:"";if(null!==f)var o=[v,t,f];else{var o=null;nl=u}}else{var o=null;nl=u}}else{var o=null;nl=u}var c=null!==o?function(){return q()}():null;if(null!==c)var h=c;else{var h=null;nl=n}return vl[r]={nextPos:nl,result:h},h}function p(){var r="tagChapter@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl,s=d(),v=null!==s?s:"";if(null!==v){if("[chapter:"===l.substr(nl,9)){var t="[chapter:";nl+=9}else{var t=null;ul&&a('"[chapter:"')}if(null!==t){var i=f();if(null!==i){if("]"===l.substr(nl,1)){var o="]";nl+=1}else{var o=null;ul&&a('"]"')}if(null!==o){var c=d(),h=null!==c?c:"";if(null!==h)var x=[v,t,i,o,h];else{var x=null;nl=u}}else{var x=null;nl=u}}else{var x=null;nl=u}}else{var x=null;nl=u}}else{var x=null;nl=u}var P=null!==x?function(l){return M(l)}(x[2]):null;if(null!==P)var p=P;else{var p=null;nl=n}return vl[r]={nextPos:nl,result:p},p}function b(){var r="tagPixivimage@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl;if("[pixivimage:"===l.substr(nl,12)){var s="[pixivimage:";nl+=12}else{var s=null;ul&&a('"[pixivimage:"')}if(null!==s){var v=j();if(null!==v){var t=nl;if("-"===l.substr(nl,1)){var i="-";nl+=1}else{var i=null;ul&&a('"-"')}if(null!==i){var f=y();if(null!==f)var o=[i,f];else{var o=null;nl=t}}else{var o=null;nl=t}var c=null!==o?o:"";if(null!==c){if("]"===l.substr(nl,1)){var h="]";nl+=1}else{var h=null;ul&&a('"]"')}if(null!==h)var x=[s,v,c,h];else{var x=null;nl=u}}else{var x=null;nl=u}}else{var x=null;nl=u}}else{var x=null;nl=u}var P=null!==x?function(l,r){return K(l,r&&r[1])}(x[1],x[2]):null;if(null!==P)var p=P;else{var p=null;nl=n}return vl[r]={nextPos:nl,result:p},p}function m(){var r="tagJump@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl;if("[jump:"===l.substr(nl,6)){var s="[jump:";nl+=6}else{var s=null;ul&&a('"[jump:"')}if(null!==s){var v=y();if(null!==v){if("]"===l.substr(nl,1)){var t="]";nl+=1}else{var t=null;ul&&a('"]"')}if(null!==t)var i=[s,v,t];else{var i=null;nl=u}}else{var i=null;nl=u}}else{var i=null;nl=u}var f=null!==i?function(l){return Y(l)}(i[1]):null;if(null!==f)var o=f;else{var o=null;nl=n}return vl[r]={nextPos:nl,result:o},o}function g(){var r="tagJumpuri@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl;if("[[jumpuri:"===l.substr(nl,10)){var s="[[jumpuri:";nl+=10}else{var s=null;ul&&a('"[[jumpuri:"')}if(null!==s){var v=h();if(null!==v){if(">"===l.substr(nl,1)){var t=">";nl+=1}else{var t=null;ul&&a('">"')}if(null!==t){for(var i=[],f=$();null!==f;){i.push(f);var f=$()}if(null!==i){var o=F();if(null!==o){for(var c=[],x=$();null!==x;){c.push(x);var x=$()}if(null!==c){if("]]"===l.substr(nl,2)){var P="]]";nl+=2}else{var P=null;ul&&a('"]]"')}if(null!==P)var p=[s,v,t,i,o,c,P];else{var p=null;nl=u}}else{var p=null;nl=u}}else{var p=null;nl=u}}else{var p=null;nl=u}}else{var p=null;nl=u}}else{var p=null;nl=u}}else{var p=null;nl=u}var b=null!==p?function(l,r){return ll(l,r)}(p[1],p[4]):null;if(null!==b)var m=b;else{var m=null;nl=n}return vl[r]={nextPos:nl,result:m},m}function A(){var r="chapterTitle@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=[];if(null!==l.substr(nl).match(/^[^\]]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[^\\]]")}for(;null!==s;)if(u.push(s),null!==l.substr(nl).match(/^[^\]]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[^\\]]")}var v=null!==u?function(l){return X(l.join(""))}(u):null;if(null!==v)var t=v;else{var t=null;nl=n}return vl[r]={nextPos:nl,result:t},t}function T(){var r="jumpuriTitle@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=[];if(null!==l.substr(nl).match(/^[^>]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[^>]")}for(;null!==s;)if(u.push(s),null!==l.substr(nl).match(/^[^>]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[^>]")}var v=null!==u?function(l){return X(l.join(""))}(u):null;if(null!==v)var t=v;else{var t=null;nl=n}return vl[r]={nextPos:nl,result:t},t}function j(){var l="numeric@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=nl,n=D();if(null!==n)for(var u=[];null!==n;){u.push(n);var n=D()}else var u=null;var a=null!==u?function(l){return l.join("")}(u):null;if(null!==a)var s=a;else{var s=null;nl=e}return vl[l]={nextPos:nl,result:s},s}function y(){var l="integer@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=nl,n=D();if(null!==n)for(var u=[];null!==n;){u.push(n);var n=D()}else var u=null;var a=null!==u?function(l){return parseInt(l.join(""),10)}(u):null;if(null!==a)var s=a;else{var s=null;nl=e}return vl[l]={nextPos:nl,result:s},s}function F(){var r="URI@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl,s=nl;if("http"===l.substr(nl,4)){var v="http";nl+=4}else{var v=null;ul&&a('"http"')}if(null!==v){if("s"===l.substr(nl,1)){var t="s";nl+=1}else{var t=null;ul&&a('"s"')}var i=null!==t?t:"";if(null!==i){if("://"===l.substr(nl,3)){var f="://";nl+=3}else{var f=null;ul&&a('"://"')}if(null!==f)var o=[v,i,f];else{var o=null;nl=s}}else{var o=null;nl=s}}else{var o=null;nl=s}if(null!==o){for(var c=[],h=C();null!==h;){c.push(h);var h=C()}if(null!==c)var x=[o,c];else{var x=null;nl=u}}else{var x=null;nl=u}var P=null!==x?function(l,r){return l.join("")+r.join("")}(x[0],x[1]):null;if(null!==P)var p=P;else{var p=null;nl=n}return vl[r]={nextPos:nl,result:p},p}function C(){var r="uri_chrs@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=S();if(null!==n)var u=n;else{var s=D();if(null!==s)var u=s;else{var v=E();if(null!==v)var u=v;else{if(null!==l.substr(nl).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var t=l.charAt(nl);nl++}else{var t=null;ul&&a("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==t)var u=t;else var u=null}}}return vl[r]={nextPos:nl,result:u},u}function E(){var r="percent_token@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl;if("%"===l.substr(nl,1)){var s="%";nl+=1}else{var s=null;ul&&a('"%"')}if(null!==s){var v=B();if(null!==v)for(var t=[];null!==v;){t.push(v);var v=B()}else var t=null;if(null!==t)var i=[s,t];else{var i=null;nl=u}}else{var i=null;nl=u}var f=null!==i?function(l){return"%"+l.join("")}(i[1]):null;if(null!==f)var o=f;else{var o=null;nl=n}return vl[r]={nextPos:nl,result:o},o}function I(){var r="tagRuby@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=nl,u=nl;if("[[rb:"===l.substr(nl,5)){var s="[[rb:";nl+=5}else{var s=null;ul&&a('"[[rb:"')}if(null!==s){var v=[];if(null!==l.substr(nl).match(/^[^>]/)){var t=l.charAt(nl);nl++}else{var t=null;ul&&a("[^>]")}for(;null!==t;)if(v.push(t),null!==l.substr(nl).match(/^[^>]/)){var t=l.charAt(nl);nl++}else{var t=null;ul&&a("[^>]")}if(null!==v){if(">"===l.substr(nl,1)){var i=">";nl+=1}else{var i=null;ul&&a('">"')}if(null!==i){var f=[];if(null!==l.substr(nl).match(/^[^\]]/)){var o=l.charAt(nl);nl++}else{var o=null;ul&&a("[^\\]]")}if(null!==o)for(var c=[];null!==o;)if(c.push(o),null!==l.substr(nl).match(/^[^\]]/)){var o=l.charAt(nl);nl++}else{var o=null;ul&&a("[^\\]]")}else var c=null;if(null!==c)var h=c;else{var x=nl;if("]"===l.substr(nl,1)){var P="]";nl+=1}else{var P=null;ul&&a('"]"')}if(null!==P){var p=nl,b=ul;ul=!1;var m=nl,g=ul;if(ul=!1,"]"===l.substr(nl,1)){var A="]";nl+=1}else{var A=null;ul&&a('"]"')}if(ul=g,null===A)var T="";else{var T=null;nl=m}if(ul=b,null!==T){var j="";nl=p}else var j=null;if(null!==j)var y=[P,j];else{var y=null;nl=x}}else{var y=null;nl=x}if(null!==y)var h=y;else var h=null}for(;null!==h;){if(f.push(h),null!==l.substr(nl).match(/^[^\]]/)){var o=l.charAt(nl);nl++}else{var o=null;ul&&a("[^\\]]")}if(null!==o)for(var c=[];null!==o;)if(c.push(o),null!==l.substr(nl).match(/^[^\]]/)){var o=l.charAt(nl);nl++}else{var o=null;ul&&a("[^\\]]")}else var c=null;if(null!==c)var h=c;else{var x=nl;if("]"===l.substr(nl,1)){var P="]";nl+=1}else{var P=null;ul&&a('"]"')}if(null!==P){var p=nl,b=ul;ul=!1;var m=nl,g=ul;if(ul=!1,"]"===l.substr(nl,1)){var A="]";nl+=1}else{var A=null;ul&&a('"]"')}if(ul=g,null===A)var T="";else{var T=null;nl=m}if(ul=b,null!==T){var j="";nl=p}else var j=null;if(null!==j)var y=[P,j];else{var y=null;nl=x}}else{var y=null;nl=x}if(null!==y)var h=y;else var h=null}}if(null!==f){if("]]"===l.substr(nl,2)){var F="]]";nl+=2}else{var F=null;ul&&a('"]]"')}if(null!==F)var C=[s,v,i,f,F];else{var C=null;nl=u}}else{var C=null;nl=u}}else{var C=null;nl=u}}else{var C=null;nl=u}}else{var C=null;nl=u}var E=null!==C?function(l,r){return rl(X(l.join("")),X(V(r).join("")))}(C[1],C[3]):null;if(null!==E)var I=E;else{var I=null;nl=n}return vl[r]={nextPos:nl,result:I},I}function d(){var l="newLine@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=J();if(null!==e)var n=e;else{var u=nl,a=L();if(null!==a){var s=J(),v=null!==s?s:"";if(null!==v)var t=[a,v];else{var t=null;nl=u}}else{var t=null;nl=u}if(null!==t)var n=t;else var n=null}return vl[l]={nextPos:nl,result:n},n}function S(){var r="ALPHA@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if(null!==l.substr(nl).match(/^[A-Z]/)){var n=l.charAt(nl);nl++}else{var n=null;ul&&a("[A-Z]")}if(null!==n)var u=n;else{if(null!==l.substr(nl).match(/^[a-z]/)){var s=l.charAt(nl);nl++}else{var s=null;ul&&a("[a-z]")}if(null!==s)var u=s;else var u=null}return vl[r]={nextPos:nl,result:u},u}function N(){var r="BIT@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if("0"===l.substr(nl,1)){var n="0";nl+=1}else{var n=null;ul&&a('"0"')}if(null!==n)var u=n;else{if("1"===l.substr(nl,1)){var s="1";nl+=1}else{var s=null;ul&&a('"1"')}if(null!==s)var u=s;else var u=null}return vl[r]={nextPos:nl,result:u},u}function w(){var r="CHAR@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if(null!==l.substr(nl).match(/^[-]/)){var n=l.charAt(nl);nl++}else{var n=null;ul&&a("[-]")}return vl[r]={nextPos:nl,result:n},n}function L(){var r="CR@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if("\r"===l.substr(nl,1)){var n="\r";nl+=1}else{var n=null;ul&&a('"\\r"')}return vl[r]={nextPos:nl,result:n},n}function R(){var l="CRLF@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=nl,n=L();if(null!==n){var u=J();if(null!==u)var a=[n,u];else{var a=null;nl=e}}else{var a=null;nl=e}return vl[l]={nextPos:nl,result:a},a}function k(){var r="CTL@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if(null!==l.substr(nl).match(/^[\0-]/)){var n=l.charAt(nl);nl++}else{var n=null;ul&&a("[\\0-]")}if(null!==n)var u=n;else{if(""===l.substr(nl,1)){var s="";nl+=1}else{var s=null;ul&&a('""')}if(null!==s)var u=s;else var u=null}return vl[r]={nextPos:nl,result:u},u}function D(){var r="DIGIT@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if(null!==l.substr(nl).match(/^[0-9]/)){var n=l.charAt(nl);nl++}else{var n=null;ul&&a("[0-9]")}return vl[r]={nextPos:nl,result:n},n}function H(){var r="DQUOTE@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if(null!==l.substr(nl).match(/^["]/)){var n=l.charAt(nl);nl++}else{var n=null;ul&&a('["]')}return vl[r]={nextPos:nl,result:n},n}function B(){var r="HEXDIG@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;var n=D();if(null!==n)var u=n;else{if("A"===l.substr(nl,1)){var s="A";nl+=1}else{var s=null;ul&&a('"A"')}if(null!==s)var u=s;else{if("B"===l.substr(nl,1)){var v="B";nl+=1}else{var v=null;ul&&a('"B"')}if(null!==v)var u=v;else{if("C"===l.substr(nl,1)){var t="C";nl+=1}else{var t=null;ul&&a('"C"')}if(null!==t)var u=t;else{if("D"===l.substr(nl,1)){var i="D";nl+=1}else{var i=null;ul&&a('"D"')}if(null!==i)var u=i;else{if("E"===l.substr(nl,1)){var f="E";nl+=1}else{var f=null;ul&&a('"E"')}if(null!==f)var u=f;else{if("F"===l.substr(nl,1)){var o="F";nl+=1}else{var o=null;ul&&a('"F"')}if(null!==o)var u=o;else var u=null}}}}}}return vl[r]={nextPos:nl,result:u},u}function _(){var r="HTAB@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if("	"===l.substr(nl,1)){var n="	";nl+=1}else{var n=null;ul&&a('"	"')}return vl[r]={nextPos:nl,result:n},n}function J(){var r="LF@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if("\n"===l.substr(nl,1)){var n="\n";nl+=1}else{var n=null;ul&&a('"\\n"')}return vl[r]={nextPos:nl,result:n},n}function O(){var l="LWSP@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=[],n=$();if(null!==n)var u=n;else{var a=nl,s=R();if(null!==s){var v=$();if(null!==v)var t=[s,v];else{var t=null;nl=a}}else{var t=null;nl=a}if(null!==t)var u=t;else var u=null}for(;null!==u;){e.push(u);var n=$();if(null!==n)var u=n;else{var a=nl,s=R();if(null!==s){var v=$();if(null!==v)var t=[s,v];else{var t=null;nl=a}}else{var t=null;nl=a}if(null!==t)var u=t;else var u=null}}return vl[l]={nextPos:nl,result:e},e}function U(){var r="OCTET@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if(null!==l.substr(nl).match(/^[\0-\xFF]/)){var n=l.charAt(nl);nl++}else{var n=null;ul&&a("[\\0-\\xFF]")}return vl[r]={nextPos:nl,result:n},n}function G(){var r="SP@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if(" "===l.substr(nl,1)){var n=" ";nl+=1}else{var n=null;ul&&a('" "')}return vl[r]={nextPos:nl,result:n},n}function W(){var r="VCHAR@"+nl,e=vl[r];if(e)return nl=e.nextPos,e.result;if(null!==l.substr(nl).match(/^[!-~]/)){var n=l.charAt(nl);nl++}else{var n=null;ul&&a("[!-~]")}return vl[r]={nextPos:nl,result:n},n}function $(){var l="WSP@"+nl,r=vl[l];if(r)return nl=r.nextPos,r.result;var e=G();if(null!==e)var n=e;else{var u=_();if(null!==u)var n=u;else var n=null}return vl[l]={nextPos:nl,result:n},n}function z(){function r(l){l.sort();for(var r=null,e=[],n=0;n<l.length;n++)l[n]!==r&&(e.push(l[n]),r=l[n]);switch(e.length){case 0:return"end of input";case 1:return e[0];default:return e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}}var e=r(sl),n=Math.max(nl,al),a=n<l.length?u(l.charAt(n)):"end of input";return"Expected "+e+" but "+a+" found."}function Q(){for(var r=1,e=1,n=!1,u=0;al>u;u++){var a=l.charAt(u);"\n"===a?(n||r++,e=1,n=!1):"\r"===a|"\u2028"===a||"\u2029"===a?(r++,e=1,n=!0):(e++,n=!1)}return{line:r,column:e}}function V(l){for(var r=[],e=0;e<l.length;e++)"object"==typeof l[e]?r=r.concat(V(l[e])):r.push(l[e]);return r}function X(l){return l.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function Z(l){return{type:"text",val:l}}function q(){return{type:"tag",name:"newpage"}}function M(l){return{type:"tag",name:"chapter",title:l}}function K(l,r){return{type:"tag",name:"pixivimage",illustID:l,pageNumber:r||null}}function Y(l){return{type:"tag",name:"jump",pageNumber:l}}function ll(l,r){return{type:"tag",name:"jumpuri",title:l,uri:r}}function rl(l,r){return{type:"tag",name:"rb",rubyBase:l,rubyText:r}}var el={ALPHA:S,BIT:N,CHAR:w,CR:L,CRLF:R,CTL:k,DIGIT:D,DQUOTE:H,HEXDIG:B,HTAB:_,LF:J,LWSP:O,OCTET:U,SP:G,URI:F,VCHAR:W,WSP:$,chapterTitle:A,inlineInlineText:o,inlineInlineToken:c,inlineInlineTokens:h,inlineText:t,inlineToken:i,inlineTokens:f,integer:y,jumpuriTitle:T,newLine:d,novel:s,numeric:j,percent_token:E,tag:x,tagChapter:p,tagJump:m,tagJumpuri:g,tagNewpage:P,tagPixivimage:b,tagRuby:I,text:v,uri_chrs:C};if(void 0!==r){if(void 0===el[r])throw Error("Invalid rule name: "+u(r)+".")}else r="novel";var nl=0,ul=!0,al=0,sl=[],vl={},tl=el[r]();if(null===tl||nl!==l.length){var il=Q();throw new this.SyntaxError(z(),il.line,il.column)}return tl},toSource:function(){return this._source}};return l.SyntaxError=function(l,r,e){this.name="SyntaxError",this.message=l,this.line=r,this.column=e},l.SyntaxError.prototype=Error.prototype,l}();r?module.exports=e:(l.PixivNovelParser=l.PixivNovelParser||{},l.PixivNovelParser.basicParser=e)}((this||0).self||global),function(l){var r="process"in l,e=function(){var l={parse:function(l,r){function e(l,r,e){for(var n=l,u=e-l.length,a=0;u>a;a++)n=r+n;return n}function n(l){var r=l.charCodeAt(0);if(255>=r)var n="x",u=2;else var n="u",u=4;return"\\"+n+e(r.toString(16).toUpperCase(),"0",u)}function u(l){return'"'+l.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,n)+'"'}function a(l){fl>tl||(tl>fl&&(fl=tl,ol=[]),ol.push(l))}function s(){var l="novel@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=[],n=x();if(null!==n)var u=n;else{var a=v();if(null!==a)var u=a;else var u=null}for(;null!==u;){e.push(u);var n=x();if(null!==n)var u=n;else{var a=v();if(null!==a)var u=a;else var u=null}}return cl[l]={nextPos:tl,result:e},e}function v(){var r="text@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl;if(null!==l.substr(tl).match(/^[^[\r\n]/)){var u=l.charAt(tl);tl++}else{var u=null;il&&a("[^[\\r\\n]")}if(null!==u)for(var s=[];null!==u;)if(s.push(u),null!==l.substr(tl).match(/^[^[\r\n]/)){var u=l.charAt(tl);tl++}else{var u=null;il&&a("[^[\\r\\n]")}else var s=null;if(null!==s)var v=s;else{var t=tl,i=tl,f=il;il=!1;var o=tl,c=il;il=!1;var h=x();if(il=c,null===h)var b="";else{var b=null;tl=o}if(il=f,null!==b){var m="";tl=i}else var m=null;if(null!==m){if("["===l.substr(tl,1)){var g="[";tl+=1}else{var g=null;il&&a('"["')}if(null!==g)var A=[m,g];else{var A=null;tl=t}}else{var A=null;tl=t}if(null!==A)var v=A;else{var T=tl,j=tl,y=il;il=!1;var F=tl,C=il;il=!1;var E=P();if(null!==E)var I=E;else{var d=p();if(null!==d)var I=d;else var I=null}if(il=C,null===I)var S="";else{var S=null;tl=F}if(il=y,null!==S){var N="";tl=j}else var N=null;if(null!==N){var L=w();if(null!==L)var R=[N,L];else{var R=null;tl=T}}else{var R=null;tl=T}if(null!==R)var v=R;else var v=null}}if(null!==v)for(var k=[];null!==v;){if(k.push(v),null!==l.substr(tl).match(/^[^[\r\n]/)){var u=l.charAt(tl);tl++}else{var u=null;il&&a("[^[\\r\\n]")}if(null!==u)for(var s=[];null!==u;)if(s.push(u),null!==l.substr(tl).match(/^[^[\r\n]/)){var u=l.charAt(tl);tl++}else{var u=null;il&&a("[^[\\r\\n]")}else var s=null;if(null!==s)var v=s;else{var t=tl,i=tl,f=il;il=!1;var o=tl,c=il;il=!1;var h=x();if(il=c,null===h)var b="";else{var b=null;tl=o}if(il=f,null!==b){var m="";tl=i}else var m=null;if(null!==m){if("["===l.substr(tl,1)){var g="[";tl+=1}else{var g=null;il&&a('"["')}if(null!==g)var A=[m,g];else{var A=null;tl=t}}else{var A=null;tl=t}if(null!==A)var v=A;else{var T=tl,j=tl,y=il;il=!1;var F=tl,C=il;il=!1;var E=P();if(null!==E)var I=E;else{var d=p();if(null!==d)var I=d;else var I=null}if(il=C,null===I)var S="";else{var S=null;tl=F}if(il=y,null!==S){var N="";tl=j}else var N=null;if(null!==N){var L=w();if(null!==L)var R=[N,L];else{var R=null;tl=T}}else{var R=null;tl=T}if(null!==R)var v=R;else var v=null}}}else var k=null;var D=null!==k?function(l){for(var r="",e=0;e<l.length;e++)r+=l[e].join("");return K(r)}(k):null;if(null!==D)var H=D;else{var H=null;tl=n}return cl[r]={nextPos:tl,result:H},H}function t(){var r="inlineText@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl;if(null!==l.substr(tl).match(/^[^[\]]/)){var u=l.charAt(tl);tl++}else{var u=null;il&&a("[^[\\]]")}if(null!==u)for(var s=[];null!==u;)if(s.push(u),null!==l.substr(tl).match(/^[^[\]]/)){var u=l.charAt(tl);tl++}else{var u=null;il&&a("[^[\\]]")}else var s=null;if(null!==s)var v=s;else{var t=tl,i=tl,f=il;il=!1;var o=tl,c=il;il=!1;var h=I();if(il=c,null===h)var x="";else{var x=null;tl=o}if(il=f,null!==x){var P="";tl=i}else var P=null;if(null!==P){if("["===l.substr(tl,1)){var p="[";tl+=1}else{var p=null;il&&a('"["')}if(null!==p)var b=[P,p];else{var b=null;tl=t}}else{var b=null;tl=t}if(null!==b)var v=b;else var v=null}if(null!==v)for(var m=[];null!==v;){if(m.push(v),null!==l.substr(tl).match(/^[^[\]]/)){var u=l.charAt(tl);tl++}else{var u=null;il&&a("[^[\\]]")}if(null!==u)for(var s=[];null!==u;)if(s.push(u),null!==l.substr(tl).match(/^[^[\]]/)){var u=l.charAt(tl);tl++}else{var u=null;il&&a("[^[\\]]")}else var s=null;if(null!==s)var v=s;else{var t=tl,i=tl,f=il;il=!1;var o=tl,c=il;il=!1;var h=I();if(il=c,null===h)var x="";else{var x=null;tl=o}if(il=f,null!==x){var P="";tl=i}else var P=null;if(null!==P){if("["===l.substr(tl,1)){var p="[";tl+=1}else{var p=null;il&&a('"["')}if(null!==p)var b=[P,p];else{var b=null;tl=t}}else{var b=null;tl=t}if(null!==b)var v=b;else var v=null}}else var m=null;var g=null!==m?function(l){return K(M(q(l).join("")))}(m):null;if(null!==g)var A=g;else{var A=null;tl=n}return cl[r]={nextPos:tl,result:A},A}function i(){var l="inlineToken@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=I();if(null!==e)var n=e;else{var u=t();if(null!==u)var n=u;else var n=null}return cl[l]={nextPos:tl,result:n},n}function f(){var l="inlineTokens@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=i();if(null!==e)for(var n=[];null!==e;){n.push(e);var e=i()}else var n=null;return cl[l]={nextPos:tl,result:n},n}function o(){var r="inlineInlineText@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl;if(null!==l.substr(tl).match(/^[^[>]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[^[>]")}if(null!==s)for(var v=[];null!==s;)if(v.push(s),null!==l.substr(tl).match(/^[^[>]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[^[>]")}else var v=null;if(null!==v){var t=tl,i=il;il=!1;var f=tl,o=il;if(il=!1,"]]"===l.substr(tl,2)){var c="]]";tl+=2}else{var c=null;il&&a('"]]"')}if(il=o,null===c)var h="";else{var h=null;tl=f}if(il=i,null!==h){var x="";tl=t}else var x=null;if(null!==x)var P=[v,x];else{var P=null;tl=u}}else{var P=null;tl=u}if(null!==P)var p=P;else{var b=tl,m=tl,g=il;il=!1;var A=tl,T=il;il=!1;var j=I();if(il=T,null===j)var y="";else{var y=null;tl=A}if(il=g,null!==y){var F="";tl=m}else var F=null;if(null!==F){if("["===l.substr(tl,1)){var C="[";tl+=1}else{var C=null;il&&a('"["')}if(null!==C)var E=[F,C];else{var E=null;tl=b}}else{var E=null;tl=b}if(null!==E)var p=E;else var p=null}if(null!==p)for(var d=[];null!==p;){d.push(p);var u=tl;if(null!==l.substr(tl).match(/^[^[>]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[^[>]")}if(null!==s)for(var v=[];null!==s;)if(v.push(s),null!==l.substr(tl).match(/^[^[>]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[^[>]")}else var v=null;if(null!==v){var t=tl,i=il;il=!1;var f=tl,o=il;if(il=!1,"]]"===l.substr(tl,2)){var c="]]";tl+=2}else{var c=null;il&&a('"]]"')}if(il=o,null===c)var h="";else{var h=null;tl=f}if(il=i,null!==h){var x="";tl=t}else var x=null;if(null!==x)var P=[v,x];else{var P=null;tl=u}}else{var P=null;tl=u}if(null!==P)var p=P;else{var b=tl,m=tl,g=il;il=!1;var A=tl,T=il;il=!1;var j=I();if(il=T,null===j)var y="";else{var y=null;tl=A}if(il=g,null!==y){var F="";tl=m}else var F=null;if(null!==F){if("["===l.substr(tl,1)){var C="[";tl+=1}else{var C=null;il&&a('"["')}if(null!==C)var E=[F,C];else{var E=null;tl=b}}else{var E=null;tl=b}if(null!==E)var p=E;else var p=null}}else var d=null;var S=null!==d?function(l){return K(M(q(l).join("")))}(d):null;if(null!==S)var N=S;else{var N=null;tl=n}return cl[r]={nextPos:tl,result:N},N}function c(){var l="inlineInlineToken@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=I();if(null!==e)var n=e;else{var u=o();if(null!==u)var n=u;else var n=null}return cl[l]={nextPos:tl,result:n},n}function h(){var l="inlineInlineTokens@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=c();if(null!==e)for(var n=[];null!==e;){n.push(e);var e=c()}else var n=null;return cl[l]={nextPos:tl,result:n},n}function x(){var l="tag@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=P();if(null!==e)var n=e;else{var u=p();if(null!==u)var n=u;else{var a=b();if(null!==a)var n=a;else{var s=m();if(null!==s)var n=s;else{var v=g();if(null!==v)var n=v;else{var t=I();if(null!==t)var n=t;else{var i=d();if(null!==i)var n=i;else{var f=S();if(null!==f)var n=f;else var n=null}}}}}}}return cl[l]={nextPos:tl,result:n},n}function P(){var r="tagNewpage@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl,s=w(),v=null!==s?s:"";if(null!==v){if("[newpage]"===l.substr(tl,9)){var t="[newpage]";tl+=9}else{var t=null;il&&a('"[newpage]"')}if(null!==t){var i=w(),f=null!==i?i:"";if(null!==f)var o=[v,t,f];else{var o=null;tl=u}}else{var o=null;tl=u}}else{var o=null;tl=u}var c=null!==o?function(){return Y()}():null;if(null!==c)var h=c;else{var h=null;tl=n}return cl[r]={nextPos:tl,result:h},h}function p(){var r="tagChapter@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl,s=w(),v=null!==s?s:"";if(null!==v){if("[chapter:"===l.substr(tl,9)){var t="[chapter:";tl+=9}else{var t=null;il&&a('"[chapter:"')}if(null!==t){var i=f();if(null!==i){if("]"===l.substr(tl,1)){var o="]";tl+=1}else{var o=null;il&&a('"]"')}if(null!==o){var c=w(),h=null!==c?c:"";if(null!==h)var x=[v,t,i,o,h];else{var x=null;tl=u}}else{var x=null;tl=u}}else{var x=null;tl=u}}else{var x=null;tl=u}}else{
var x=null;tl=u}var P=null!==x?function(l){return ll(l)}(x[2]):null;if(null!==P)var p=P;else{var p=null;tl=n}return cl[r]={nextPos:tl,result:p},p}function b(){var r="tagPixivimage@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl;if("[pixivimage:"===l.substr(tl,12)){var s="[pixivimage:";tl+=12}else{var s=null;il&&a('"[pixivimage:"')}if(null!==s){var v=j();if(null!==v){var t=tl;if("-"===l.substr(tl,1)){var i="-";tl+=1}else{var i=null;il&&a('"-"')}if(null!==i){var f=y();if(null!==f)var o=[i,f];else{var o=null;tl=t}}else{var o=null;tl=t}var c=null!==o?o:"";if(null!==c){if("]"===l.substr(tl,1)){var h="]";tl+=1}else{var h=null;il&&a('"]"')}if(null!==h)var x=[s,v,c,h];else{var x=null;tl=u}}else{var x=null;tl=u}}else{var x=null;tl=u}}else{var x=null;tl=u}var P=null!==x?function(l,r){return rl(l,r&&r[1])}(x[1],x[2]):null;if(null!==P)var p=P;else{var p=null;tl=n}return cl[r]={nextPos:tl,result:p},p}function m(){var r="tagJump@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl;if("[jump:"===l.substr(tl,6)){var s="[jump:";tl+=6}else{var s=null;il&&a('"[jump:"')}if(null!==s){var v=y();if(null!==v){if("]"===l.substr(tl,1)){var t="]";tl+=1}else{var t=null;il&&a('"]"')}if(null!==t)var i=[s,v,t];else{var i=null;tl=u}}else{var i=null;tl=u}}else{var i=null;tl=u}var f=null!==i?function(l){return el(l)}(i[1]):null;if(null!==f)var o=f;else{var o=null;tl=n}return cl[r]={nextPos:tl,result:o},o}function g(){var r="tagJumpuri@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl;if("[[jumpuri:"===l.substr(tl,10)){var s="[[jumpuri:";tl+=10}else{var s=null;il&&a('"[[jumpuri:"')}if(null!==s){var v=h();if(null!==v){if(">"===l.substr(tl,1)){var t=">";tl+=1}else{var t=null;il&&a('">"')}if(null!==t){for(var i=[],f=V();null!==f;){i.push(f);var f=V()}if(null!==i){var o=F();if(null!==o){for(var c=[],x=V();null!==x;){c.push(x);var x=V()}if(null!==c){if("]]"===l.substr(tl,2)){var P="]]";tl+=2}else{var P=null;il&&a('"]]"')}if(null!==P)var p=[s,v,t,i,o,c,P];else{var p=null;tl=u}}else{var p=null;tl=u}}else{var p=null;tl=u}}else{var p=null;tl=u}}else{var p=null;tl=u}}else{var p=null;tl=u}}else{var p=null;tl=u}var b=null!==p?function(l,r){return nl(l,r)}(p[1],p[4]):null;if(null!==b)var m=b;else{var m=null;tl=n}return cl[r]={nextPos:tl,result:m},m}function A(){var r="chapterTitle@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=[];if(null!==l.substr(tl).match(/^[^\]]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[^\\]]")}for(;null!==s;)if(u.push(s),null!==l.substr(tl).match(/^[^\]]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[^\\]]")}var v=null!==u?function(l){return M(l.join(""))}(u):null;if(null!==v)var t=v;else{var t=null;tl=n}return cl[r]={nextPos:tl,result:t},t}function T(){var r="jumpuriTitle@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=[];if(null!==l.substr(tl).match(/^[^>]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[^>]")}for(;null!==s;)if(u.push(s),null!==l.substr(tl).match(/^[^>]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[^>]")}var v=null!==u?function(l){return M(l.join(""))}(u):null;if(null!==v)var t=v;else{var t=null;tl=n}return cl[r]={nextPos:tl,result:t},t}function j(){var l="numeric@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=tl,n=_();if(null!==n)for(var u=[];null!==n;){u.push(n);var n=_()}else var u=null;var a=null!==u?function(l){return l.join("")}(u):null;if(null!==a)var s=a;else{var s=null;tl=e}return cl[l]={nextPos:tl,result:s},s}function y(){var l="integer@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=tl,n=_();if(null!==n)for(var u=[];null!==n;){u.push(n);var n=_()}else var u=null;var a=null!==u?function(l){return parseInt(l.join(""),10)}(u):null;if(null!==a)var s=a;else{var s=null;tl=e}return cl[l]={nextPos:tl,result:s},s}function F(){var r="URI@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl,s=tl;if("http"===l.substr(tl,4)){var v="http";tl+=4}else{var v=null;il&&a('"http"')}if(null!==v){if("s"===l.substr(tl,1)){var t="s";tl+=1}else{var t=null;il&&a('"s"')}var i=null!==t?t:"";if(null!==i){if("://"===l.substr(tl,3)){var f="://";tl+=3}else{var f=null;il&&a('"://"')}if(null!==f)var o=[v,i,f];else{var o=null;tl=s}}else{var o=null;tl=s}}else{var o=null;tl=s}if(null!==o){for(var c=[],h=C();null!==h;){c.push(h);var h=C()}if(null!==c)var x=[o,c];else{var x=null;tl=u}}else{var x=null;tl=u}var P=null!==x?function(l,r){return l.join("")+r.join("")}(x[0],x[1]):null;if(null!==P)var p=P;else{var p=null;tl=n}return cl[r]={nextPos:tl,result:p},p}function C(){var r="uri_chrs@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=L();if(null!==n)var u=n;else{var s=_();if(null!==s)var u=s;else{var v=E();if(null!==v)var u=v;else{if(null!==l.substr(tl).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var t=l.charAt(tl);tl++}else{var t=null;il&&a("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==t)var u=t;else var u=null}}}return cl[r]={nextPos:tl,result:u},u}function E(){var r="percent_token@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl;if("%"===l.substr(tl,1)){var s="%";tl+=1}else{var s=null;il&&a('"%"')}if(null!==s){var v=O();if(null!==v)for(var t=[];null!==v;){t.push(v);var v=O()}else var t=null;if(null!==t)var i=[s,t];else{var i=null;tl=u}}else{var i=null;tl=u}var f=null!==i?function(l){return"%"+l.join("")}(i[1]):null;if(null!==f)var o=f;else{var o=null;tl=n}return cl[r]={nextPos:tl,result:o},o}function I(){var r="tagRuby@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl;if("[[rb:"===l.substr(tl,5)){var s="[[rb:";tl+=5}else{var s=null;il&&a('"[[rb:"')}if(null!==s){var v=[];if(null!==l.substr(tl).match(/^[^>]/)){var t=l.charAt(tl);tl++}else{var t=null;il&&a("[^>]")}for(;null!==t;)if(v.push(t),null!==l.substr(tl).match(/^[^>]/)){var t=l.charAt(tl);tl++}else{var t=null;il&&a("[^>]")}if(null!==v){if(">"===l.substr(tl,1)){var i=">";tl+=1}else{var i=null;il&&a('">"')}if(null!==i){var f=[];if(null!==l.substr(tl).match(/^[^\]]/)){var o=l.charAt(tl);tl++}else{var o=null;il&&a("[^\\]]")}if(null!==o)for(var c=[];null!==o;)if(c.push(o),null!==l.substr(tl).match(/^[^\]]/)){var o=l.charAt(tl);tl++}else{var o=null;il&&a("[^\\]]")}else var c=null;if(null!==c)var h=c;else{var x=tl;if("]"===l.substr(tl,1)){var P="]";tl+=1}else{var P=null;il&&a('"]"')}if(null!==P){var p=tl,b=il;il=!1;var m=tl,g=il;if(il=!1,"]"===l.substr(tl,1)){var A="]";tl+=1}else{var A=null;il&&a('"]"')}if(il=g,null===A)var T="";else{var T=null;tl=m}if(il=b,null!==T){var j="";tl=p}else var j=null;if(null!==j)var y=[P,j];else{var y=null;tl=x}}else{var y=null;tl=x}if(null!==y)var h=y;else var h=null}for(;null!==h;){if(f.push(h),null!==l.substr(tl).match(/^[^\]]/)){var o=l.charAt(tl);tl++}else{var o=null;il&&a("[^\\]]")}if(null!==o)for(var c=[];null!==o;)if(c.push(o),null!==l.substr(tl).match(/^[^\]]/)){var o=l.charAt(tl);tl++}else{var o=null;il&&a("[^\\]]")}else var c=null;if(null!==c)var h=c;else{var x=tl;if("]"===l.substr(tl,1)){var P="]";tl+=1}else{var P=null;il&&a('"]"')}if(null!==P){var p=tl,b=il;il=!1;var m=tl,g=il;if(il=!1,"]"===l.substr(tl,1)){var A="]";tl+=1}else{var A=null;il&&a('"]"')}if(il=g,null===A)var T="";else{var T=null;tl=m}if(il=b,null!==T){var j="";tl=p}else var j=null;if(null!==j)var y=[P,j];else{var y=null;tl=x}}else{var y=null;tl=x}if(null!==y)var h=y;else var h=null}}if(null!==f){if("]]"===l.substr(tl,2)){var F="]]";tl+=2}else{var F=null;il&&a('"]]"')}if(null!==F)var C=[s,v,i,f,F];else{var C=null;tl=u}}else{var C=null;tl=u}}else{var C=null;tl=u}}else{var C=null;tl=u}}else{var C=null;tl=u}var E=null!==C?function(l,r){return ul(M(l.join("")),M(q(r).join("")))}(C[1],C[3]):null;if(null!==E)var I=E;else{var I=null;tl=n}return cl[r]={nextPos:tl,result:I},I}function d(){var r="tagEmoji@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl;if("[emoji:"===l.substr(tl,7)){var s="[emoji:";tl+=7}else{var s=null;il&&a('"[emoji:"')}if(null!==s){var v=N();if(null!==v){if("]"===l.substr(tl,1)){var t="]";tl+=1}else{var t=null;il&&a('"]"')}if(null!==t)var i=[s,v,t];else{var i=null;tl=u}}else{var i=null;tl=u}}else{var i=null;tl=u}var f=null!==i?function(l){return al(l)}(i[1]):null;if(null!==f)var o=f;else{var o=null;tl=n}return cl[r]={nextPos:tl,result:o},o}function S(){var r="tagStrong@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=tl;if("[strong:"===l.substr(tl,8)){var s="[strong:";tl+=8}else{var s=null;il&&a('"[strong:"')}if(null!==s){var v=[];if(null!==l.substr(tl).match(/^[^\]]/)){var t=l.charAt(tl);tl++}else{var t=null;il&&a("[^\\]]")}for(;null!==t;)if(v.push(t),null!==l.substr(tl).match(/^[^\]]/)){var t=l.charAt(tl);tl++}else{var t=null;il&&a("[^\\]]")}if(null!==v){if("]"===l.substr(tl,1)){var i="]";tl+=1}else{var i=null;il&&a('"]"')}if(null!==i)var f=[s,v,i];else{var f=null;tl=u}}else{var f=null;tl=u}}else{var f=null;tl=u}var o=null!==f?function(l){return sl(M(l.join("")))}(f[1]):null;if(null!==o)var c=o;else{var c=null;tl=n}return cl[r]={nextPos:tl,result:c},c}function N(){var r="emojiName@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=tl,u=L();if(null!==u)var s=u;else{var v=_();if(null!==v)var s=v;else{if("-"===l.substr(tl,1)){var t="-";tl+=1}else{var t=null;il&&a('"-"')}if(null!==t)var s=t;else var s=null}}if(null!==s)for(var i=[];null!==s;){i.push(s);var u=L();if(null!==u)var s=u;else{var v=_();if(null!==v)var s=v;else{if("-"===l.substr(tl,1)){var t="-";tl+=1}else{var t=null;il&&a('"-"')}if(null!==t)var s=t;else var s=null}}}else var i=null;var f=null!==i?function(l){return M(l.join(""))}(i):null;if(null!==f)var o=f;else{var o=null;tl=n}return cl[r]={nextPos:tl,result:o},o}function w(){var l="newLine@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=G();if(null!==e)var n=e;else{var u=tl,a=D();if(null!==a){var s=G(),v=null!==s?s:"";if(null!==v)var t=[a,v];else{var t=null;tl=u}}else{var t=null;tl=u}if(null!==t)var n=t;else var n=null}return cl[l]={nextPos:tl,result:n},n}function L(){var r="ALPHA@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if(null!==l.substr(tl).match(/^[A-Z]/)){var n=l.charAt(tl);tl++}else{var n=null;il&&a("[A-Z]")}if(null!==n)var u=n;else{if(null!==l.substr(tl).match(/^[a-z]/)){var s=l.charAt(tl);tl++}else{var s=null;il&&a("[a-z]")}if(null!==s)var u=s;else var u=null}return cl[r]={nextPos:tl,result:u},u}function R(){var r="BIT@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if("0"===l.substr(tl,1)){var n="0";tl+=1}else{var n=null;il&&a('"0"')}if(null!==n)var u=n;else{if("1"===l.substr(tl,1)){var s="1";tl+=1}else{var s=null;il&&a('"1"')}if(null!==s)var u=s;else var u=null}return cl[r]={nextPos:tl,result:u},u}function k(){var r="CHAR@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if(null!==l.substr(tl).match(/^[-]/)){var n=l.charAt(tl);tl++}else{var n=null;il&&a("[-]")}return cl[r]={nextPos:tl,result:n},n}function D(){var r="CR@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if("\r"===l.substr(tl,1)){var n="\r";tl+=1}else{var n=null;il&&a('"\\r"')}return cl[r]={nextPos:tl,result:n},n}function H(){var l="CRLF@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=tl,n=D();if(null!==n){var u=G();if(null!==u)var a=[n,u];else{var a=null;tl=e}}else{var a=null;tl=e}return cl[l]={nextPos:tl,result:a},a}function B(){var r="CTL@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if(null!==l.substr(tl).match(/^[\0-]/)){var n=l.charAt(tl);tl++}else{var n=null;il&&a("[\\0-]")}if(null!==n)var u=n;else{if(""===l.substr(tl,1)){var s="";tl+=1}else{var s=null;il&&a('""')}if(null!==s)var u=s;else var u=null}return cl[r]={nextPos:tl,result:u},u}function _(){var r="DIGIT@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if(null!==l.substr(tl).match(/^[0-9]/)){var n=l.charAt(tl);tl++}else{var n=null;il&&a("[0-9]")}return cl[r]={nextPos:tl,result:n},n}function J(){var r="DQUOTE@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if(null!==l.substr(tl).match(/^["]/)){var n=l.charAt(tl);tl++}else{var n=null;il&&a('["]')}return cl[r]={nextPos:tl,result:n},n}function O(){var r="HEXDIG@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;var n=_();if(null!==n)var u=n;else{if("A"===l.substr(tl,1)){var s="A";tl+=1}else{var s=null;il&&a('"A"')}if(null!==s)var u=s;else{if("B"===l.substr(tl,1)){var v="B";tl+=1}else{var v=null;il&&a('"B"')}if(null!==v)var u=v;else{if("C"===l.substr(tl,1)){var t="C";tl+=1}else{var t=null;il&&a('"C"')}if(null!==t)var u=t;else{if("D"===l.substr(tl,1)){var i="D";tl+=1}else{var i=null;il&&a('"D"')}if(null!==i)var u=i;else{if("E"===l.substr(tl,1)){var f="E";tl+=1}else{var f=null;il&&a('"E"')}if(null!==f)var u=f;else{if("F"===l.substr(tl,1)){var o="F";tl+=1}else{var o=null;il&&a('"F"')}if(null!==o)var u=o;else var u=null}}}}}}return cl[r]={nextPos:tl,result:u},u}function U(){var r="HTAB@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if("	"===l.substr(tl,1)){var n="	";tl+=1}else{var n=null;il&&a('"	"')}return cl[r]={nextPos:tl,result:n},n}function G(){var r="LF@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if("\n"===l.substr(tl,1)){var n="\n";tl+=1}else{var n=null;il&&a('"\\n"')}return cl[r]={nextPos:tl,result:n},n}function W(){var l="LWSP@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=[],n=V();if(null!==n)var u=n;else{var a=tl,s=H();if(null!==s){var v=V();if(null!==v)var t=[s,v];else{var t=null;tl=a}}else{var t=null;tl=a}if(null!==t)var u=t;else var u=null}for(;null!==u;){e.push(u);var n=V();if(null!==n)var u=n;else{var a=tl,s=H();if(null!==s){var v=V();if(null!==v)var t=[s,v];else{var t=null;tl=a}}else{var t=null;tl=a}if(null!==t)var u=t;else var u=null}}return cl[l]={nextPos:tl,result:e},e}function $(){var r="OCTET@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if(null!==l.substr(tl).match(/^[\0-\xFF]/)){var n=l.charAt(tl);tl++}else{var n=null;il&&a("[\\0-\\xFF]")}return cl[r]={nextPos:tl,result:n},n}function z(){var r="SP@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if(" "===l.substr(tl,1)){var n=" ";tl+=1}else{var n=null;il&&a('" "')}return cl[r]={nextPos:tl,result:n},n}function Q(){var r="VCHAR@"+tl,e=cl[r];if(e)return tl=e.nextPos,e.result;if(null!==l.substr(tl).match(/^[!-~]/)){var n=l.charAt(tl);tl++}else{var n=null;il&&a("[!-~]")}return cl[r]={nextPos:tl,result:n},n}function V(){var l="WSP@"+tl,r=cl[l];if(r)return tl=r.nextPos,r.result;var e=z();if(null!==e)var n=e;else{var u=U();if(null!==u)var n=u;else var n=null}return cl[l]={nextPos:tl,result:n},n}function X(){function r(l){l.sort();for(var r=null,e=[],n=0;n<l.length;n++)l[n]!==r&&(e.push(l[n]),r=l[n]);switch(e.length){case 0:return"end of input";case 1:return e[0];default:return e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}}var e=r(ol),n=Math.max(tl,fl),a=n<l.length?u(l.charAt(n)):"end of input";return"Expected "+e+" but "+a+" found."}function Z(){for(var r=1,e=1,n=!1,u=0;fl>u;u++){var a=l.charAt(u);"\n"===a?(n||r++,e=1,n=!1):"\r"===a|"\u2028"===a||"\u2029"===a?(r++,e=1,n=!0):(e++,n=!1)}return{line:r,column:e}}function q(l){for(var r=[],e=0;e<l.length;e++)"object"==typeof l[e]?r=r.concat(q(l[e])):r.push(l[e]);return r}function M(l){return l.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function K(l){return{type:"text",val:l}}function Y(){return{type:"tag",name:"newpage"}}function ll(l){return{type:"tag",name:"chapter",title:l}}function rl(l,r){return{type:"tag",name:"pixivimage",illustID:l,pageNumber:r||null}}function el(l){return{type:"tag",name:"jump",pageNumber:l}}function nl(l,r){return{type:"tag",name:"jumpuri",title:l,uri:r}}function ul(l,r){return{type:"tag",name:"rb",rubyBase:l,rubyText:r}}function al(l){return{type:"tag",name:"emoji",emojiName:l}}function sl(l){return{type:"tag",name:"strong",val:l}}var vl={ALPHA:L,BIT:R,CHAR:k,CR:D,CRLF:H,CTL:B,DIGIT:_,DQUOTE:J,HEXDIG:O,HTAB:U,LF:G,LWSP:W,OCTET:$,SP:z,URI:F,VCHAR:Q,WSP:V,chapterTitle:A,emojiName:N,inlineInlineText:o,inlineInlineToken:c,inlineInlineTokens:h,inlineText:t,inlineToken:i,inlineTokens:f,integer:y,jumpuriTitle:T,newLine:w,novel:s,numeric:j,percent_token:E,tag:x,tagChapter:p,tagEmoji:d,tagJump:m,tagJumpuri:g,tagNewpage:P,tagPixivimage:b,tagRuby:I,tagStrong:S,text:v,uri_chrs:C};if(void 0!==r){if(void 0===vl[r])throw Error("Invalid rule name: "+u(r)+".")}else r="novel";var tl=0,il=!0,fl=0,ol=[],cl={},hl=vl[r]();if(null===hl||tl!==l.length){var xl=Z();throw new this.SyntaxError(X(),xl.line,xl.column)}return hl},toSource:function(){return this._source}};return l.SyntaxError=function(l,r,e){this.name="SyntaxError",this.message=l,this.line=r,this.column=e},l.SyntaxError.prototype=Error.prototype,l}();r?module.exports=e:(l.PixivNovelParser=l.PixivNovelParser||{},l.PixivNovelParser.extendedParser=e)}((this||0).self||global),function(l){"use strict";function r(l){l=l||{},this.syntax=l.syntax||"basic",this.tree=[]}var e,n,u="process"in l;u?(e=require("./parser.peg.js"),n=require("./parser-extended.peg.js")):(e=PixivNovelParser.basicParser,n=PixivNovelParser.extendedParser),r.parse=function(l,r){r=r||{},r.syntax=r.syntax||"basic";try{switch(l=l.replace(/\r?\n/g,"\n").replace(/[\s\u200c]/g,function(l){return"\n"===l||"　"===l?l:" "}),r.syntax){case"extended":return n.parse(l);case"basic":default:return e.parse(l)}}catch(u){return console.error(u),[{type:"text",val:l}]}},r.prototype.parse=function(l){return this.tree=r.parse(l,{syntax:this.syntax}),this},r.prototype.toJSON=function(){return JSON.stringify(this.tree)},u?module.exports={Parser:r}:(l.PixivNovelParser=l.PixivNovalPerser||{},l.PixivNovelParser.Parser=r)}((this||0).self||global),function(l){"use strict";var r="process"in l;r?module.exports=require("./parser"):l.PixivNovelParser=l.PixivNovelParser||{}}((this||0).self||global);
//# sourceMappingURL=pixiv-novel-parser.min.js.map